(this.webpackJsonphex=this.webpackJsonphex||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var r,n=a(0),i=a.n(n),o=a(7),l=a.n(o),c=(a(13),a(3)),s=a(5),h=a(1);a(14);!function(e){e[e.Water=0]="Water",e[e.Earth=1]="Earth",e[e.Forest=2]="Forest",e[e.Desert=3]="Desert"}(r||(r={}));var d={id:1,name:"Toute eau",center:r.Water,edges:[r.Water,r.Water,r.Water,r.Water,r.Water,r.Water]},u=(r.Water,r.Earth,r.Water,r.Water,r.Water,r.Water,r.Water,{id:3,center:r.Water,edges:[r.Earth,r.Earth,r.Water,r.Water,r.Water,r.Water]}),f={id:4,center:r.Water,edges:[r.Earth,r.Water,r.Earth,r.Water,r.Water,r.Water]},E={id:5,center:r.Water,edges:[r.Earth,r.Water,r.Water,r.Earth,r.Water,r.Water]},W={id:6,center:r.Water,edges:[r.Earth,r.Earth,r.Earth,r.Water,r.Water,r.Water]},g={id:7,center:r.Water,edges:[r.Earth,r.Earth,r.Water,r.Earth,r.Water,r.Water]},v={id:8,center:r.Water,edges:[r.Earth,r.Earth,r.Water,r.Water,r.Earth,r.Water]},m={id:9,center:r.Water,edges:[r.Earth,r.Earth,r.Earth,r.Earth,r.Water,r.Water]},y={id:10,center:r.Water,edges:[r.Earth,r.Earth,r.Earth,r.Water,r.Earth,r.Water]},b={id:11,center:r.Water,edges:[r.Earth,r.Earth,r.Water,r.Earth,r.Earth,r.Water]},T={id:12,center:r.Water,edges:[r.Earth,r.Earth,r.Earth,r.Earth,r.Earth,r.Water]},q={id:13,center:r.Water,edges:[r.Earth,r.Earth,r.Earth,r.Earth,r.Earth,r.Earth]},x={id:14,name:"Toute eau simple",center:r.Water},w={id:101,name:"Ilot central",center:r.Earth,edges:[r.Water,r.Water,r.Water,r.Water,r.Water,r.Water]},p={id:102,center:r.Earth,edges:[r.Earth,r.Water,r.Water,r.Water,r.Water,r.Water]},j={id:103,center:r.Earth,edges:[r.Earth,r.Earth,r.Water,r.Water,r.Water,r.Water]},O={id:104,center:r.Earth,edges:[r.Earth,r.Water,r.Earth,r.Water,r.Water,r.Water]},M={id:105,center:r.Earth,edges:[r.Earth,r.Water,r.Water,r.Earth,r.Water,r.Water]},P={id:106,center:r.Earth,edges:[r.Earth,r.Earth,r.Earth,r.Water,r.Water,r.Water]},S={id:107,center:r.Earth,edges:[r.Earth,r.Earth,r.Water,r.Earth,r.Water,r.Water]},k={id:108,center:r.Earth,edges:[r.Earth,r.Earth,r.Water,r.Water,r.Earth,r.Water]},C={id:109,center:r.Earth,edges:[r.Earth,r.Earth,r.Earth,r.Earth,r.Water,r.Water]},z={id:110,center:r.Earth,edges:[r.Earth,r.Earth,r.Earth,r.Water,r.Earth,r.Water]},A={id:111,center:r.Earth,edges:[r.Earth,r.Earth,r.Water,r.Earth,r.Earth,r.Water]},I={id:112,center:r.Earth,edges:[r.Earth,r.Earth,r.Earth,r.Earth,r.Earth,r.Water]},N={id:113,name:"Toute terre",center:r.Earth},D=["#7dd1ff","#a65a35"],F={tiles:[{tile:d,quantity:3},{tile:x,quantity:1},{tile:u,quantity:1},{tile:f,quantity:1},{tile:E,quantity:1},{tile:W,quantity:1},{tile:g,quantity:1},{tile:v,quantity:1},{tile:m,quantity:1},{tile:y,quantity:1},{tile:b,quantity:1},{tile:T,quantity:1},{tile:q,quantity:1},{tile:w,quantity:3},{tile:p,quantity:1},{tile:j,quantity:1},{tile:O,quantity:1},{tile:M,quantity:1},{tile:P,quantity:1},{tile:S,quantity:1},{tile:k,quantity:1},{tile:C,quantity:1},{tile:z,quantity:1},{tile:A,quantity:1},{tile:I,quantity:1},{tile:N,quantity:1}]};function H(e,t){if(e.length>t)e.unshift.apply(e,Object(c.a)(e.splice(-t)));else for(var a=0;a<t;)e.unshift(e.splice(-1)),a++;return e}var L=Math.cos(Math.PI/6);function B(e,t,a,r,n){if(!r)return console.log("drawTile => drawFilledHex",r),void R(e,t,a,"red");if(!r.edges)return console.log("drawTile => drawFilledHex",r),void R(e,t,a,n[r.center]);var i=a/3,o=t.x,l=t.y,c=a;e.beginPath(),e.moveTo(o-c*L,l-.5*c),e.lineTo(o-c*L,l+.5*c),e.lineTo(o-i*L,l+.5*i),e.lineTo(o-i*L,l-.5*i),e.closePath(),e.fillStyle=n[r.edges[0]],e.fill(),e.beginPath(),e.moveTo(o-c*L,l+.5*c),e.lineTo(o,l+c),e.lineTo(o,l+i),e.lineTo(o-i*L,l+.5*i),e.closePath(),e.fillStyle=n[r.edges[1]],e.fill(),e.beginPath(),e.moveTo(o,l+c),e.lineTo(o+c*L,l+.5*c),e.lineTo(o+i*L,l+.5*i),e.lineTo(o,l+i),e.closePath(),e.fillStyle=n[r.edges[2]],e.fill(),e.beginPath(),e.moveTo(o+c*L,l+.5*c),e.lineTo(o+c*L,l-.5*c),e.lineTo(o+i*L,l-.5*i),e.lineTo(o+i*L,l+.5*i),e.closePath(),e.fillStyle=n[r.edges[3]],e.fill(),e.beginPath(),e.moveTo(o+c*L,l-.5*c),e.lineTo(o,l-c),e.lineTo(o,l-i),e.lineTo(o+i*L,l-.5*i),e.closePath(),e.fillStyle=n[r.edges[4]],e.fill(),e.beginPath(),e.lineTo(o,l-c),e.lineTo(o-c*L,l-.5*c),e.lineTo(o-i*L,l-.5*i),e.lineTo(o,l-i),e.closePath(),e.fillStyle=n[r.edges[5]],e.fill(),e.beginPath(),e.moveTo(o-i*L,l-.5*i),e.lineTo(o-i*L,l+.5*i),e.lineTo(o,l+i),e.lineTo(o+i*L,l+.5*i),e.lineTo(o+i*L,l-.5*i),e.lineTo(o,l-i),e.lineTo(o-i*L,l-.5*i),e.closePath(),e.fillStyle=n[r.center],e.fill()}function R(e,t,a,r){var n=t.x,i=t.y,o=a;e.beginPath(),e.moveTo(n-o*L,i-.5*o),e.lineTo(n-o*L,i+.5*o),e.lineTo(n,i+o),e.lineTo(n+o*L,i+.5*o),e.lineTo(n+o*L,i-.5*o),e.lineTo(n,i-o),e.lineTo(n-o*L,i-.5*o),e.closePath(),e.fillStyle=r,e.fill()}function X(e,t){return{x:t*(Math.sqrt(3)*e.coordinates.q+Math.sqrt(3)/2*e.coordinates.r),y:t*(1.5*e.coordinates.r)}}function Y(e,t,a){var r={min:0,max:0},n=2+1.5*((r=e.tiles.reduce((function(e,t){return{min:Math.min(e.min,t.coordinates.r),max:Math.max(e.max,t.coordinates.r)}}),r)).max+-r.min+1+2-1),i=Math.floor(a/n),o=t/6/L;if(o=Math.floor(o),e.tiles.length>0){for(var l={min:Number.MAX_VALUE,max:Number.MIN_VALUE},c=0;c<e.tiles.length;c++){var s=X(e.tiles[c],10);l.min=Math.min(s.x,l.min),l.max=Math.max(s.x,l.max)}o=t/(2*((l.max-l.min+20*L)/(20*L)+2))/L,o=Math.floor(o)}return Math.min(i,o)}var J=function(e){var t=e.id,a=e.width,r=e.height,o=e.zIndex,l=e.nextTile,c=e.patterns,s=e.onClick,d=e.onWheel,u=e.playfield,f=e.tileSize,E=Object(n.useState)({x:0,y:0}),W=Object(h.a)(E,2),g=W[0],v=W[1],m=Object(n.useState)(null),y=Object(h.a)(m,2),b=y[0],T=y[1];Object(n.useEffect)((function(){var e=document.getElementById(t).getContext("2d");e&&(e.font="30px Arial"),T(e)}),[]),Object(n.useEffect)((function(){console.log("Canvas size",a,r)}),[a,r]),Object(n.useEffect)((function(){b&&g.x&&g.y&&(b.clearRect(0,0,a,r),l&&B(b,g,f,l,c))}),[g,a,r,b,l]),Object(n.useEffect)((function(){"foreground"===t&&b&&console.log("Pattern initialisation")}),[b]),Object(n.useEffect)((function(){u&&b&&(b.clearRect(0,0,a,r),function(e,t,a,r){for(var n=0;n<t.tiles.length;n++){var i=t.tiles[n],o=X(i,a);B(e,{x:e.canvas.width/2+o.x,y:e.canvas.height/2+o.y},a,i,r)}}(b,u,f,c))}),[u,f]);return i.a.createElement("canvas",{id:t,width:a,height:r,style:{border:"1px solid #000000",position:"absolute",zIndex:o},onMouseMove:function(e){e.preventDefault(),e.persist();var t={x:e.clientX,y:e.clientY};v(t)},onWheel:function(e){e.preventDefault(),e.persist(),d&&d(e.nativeEvent.deltaY)},onClick:function(e){e.preventDefault(),e.persist();var t={x:e.clientX,y:e.clientY};v(t),s&&s(t)}})},U=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],V=function(){var e=Object(n.useState)(0),t=Object(h.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(0),l=Object(h.a)(o,2),d=l[0],u=l[1],f=Object(n.useState)(25),E=Object(h.a)(f,2),W=E[0],g=E[1],v=Object(n.useState)(null),m=Object(h.a)(v,2),y=m[0],b=m[1],T=Object(n.useState)([]),q=Object(h.a)(T,2),x=q[0],w=q[1],p=Object(n.useState)({tiles:[]}),j=Object(h.a)(p,2),O=j[0],M=j[1];Object(n.useEffect)((function(){console.log("Window initial size",window.innerWidth,window.innerHeight),r(window.innerWidth),u(window.innerHeight);var e=Y({tiles:[]},window.innerWidth,window.innerHeight);console.log("initial tile size",e),g(e)}),[]),Object(n.useEffect)((function(){console.log(F);var e=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[a],e[a]=r}return e}(F.tiles.map((function(e){for(var t=[],a=0;a<e.quantity;a++)t.push(e.tile.id);return t})).flat());console.log("shuffledDeck",e);var t=F.tiles.find((function(t){return t.tile.id===e[0]})),a=t?t.tile:null;b(a),w(e)}),[]),Object(n.useEffect)((function(){var e=navigator.userAgent.toLowerCase().match(/mobile/i);console.log("isMobile ?",navigator.userAgent),console.log("isMobile ?",navigator.userAgent.toLowerCase()),console.log("isMobile ?",navigator.userAgent.toLowerCase().match(/mobile/i)),e?console.log("isMobile",!0):console.log("isMobile",!1),console.log("maxTouchPoints ?",navigator.maxTouchPoints)}),[]);return i.a.createElement(i.a.Fragment,null,a&&d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(J,{id:"background",width:a,height:d,zIndex:0,nextTile:null,patterns:D,onClick:null,onWheel:null,playfield:O,tileSize:W}),i.a.createElement(J,{id:"foreground",width:a,height:d,zIndex:1,nextTile:y,patterns:D,onClick:function(e){if(console.log("handleClick in app",e),y){var t={q:0,r:0};if(0!==O.tiles.length&&(t=function(e,t){var a=(Math.sqrt(3)/3*e.x-1/3*e.y)/t,r=2/3*e.y/t;return{q:Math.round(a),r:Math.round(r)}}({x:e.x-a/2,y:e.y-d/2},W)),void 0===O.tiles.find((function(e){return e.coordinates.q===t.q&&e.coordinates.r===t.r}))){if(0!==O.tiles.length){var r=0,n=!1,i=function(){var e={q:t.q+U[r].q,r:t.r+U[r].r};console.warn("checkCoordinates : ",r,e),n=void 0!==O.tiles.find((function(t){return t.coordinates.q===e.q&&t.coordinates.r===e.r})),console.warn("neighbor : ",r,n),r++};do{i()}while(!n&&r<U.length);if(!n)return void console.warn("No neighbor : ",t)}var o=Object(s.a)({},O,{tiles:[].concat(Object(c.a)(O.tiles),[Object(s.a)({},y,{coordinates:t})])}),l=Object(c.a)(x);if(l.length>0){var h;l.shift();var u=null===(h=F.tiles.find((function(e){return e.tile.id===l[0]})))||void 0===h?void 0:h.tile;b(u||null),console.log("newNextTile",u)}else b(null);console.log("newRemainingTiles",l),console.log("newPlayfield",o);var f=Y(o,a,d);g(f),M(o),w(l)}else console.warn("Already something here : ",t)}else console.log("No tile to add")},onWheel:function(e){if(console.log("handleWheel in app",e),y){var t=Object(s.a)({},y,{edges:H(y.edges,e>0?-1:1)});b(t)}else console.log("No tile to rotate")},playfield:null,tileSize:W})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.80e4b421.chunk.js.map