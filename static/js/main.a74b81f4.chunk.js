(this.webpackJsonphex=this.webpackJsonphex||[]).push([[0],[,,,,function(e){e.exports=JSON.parse('{"a":"hex","b":"0.1.1"}')},,,,,function(e,t,a){e.exports=a(16)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),l=a(8),o=a.n(l),c=(a(14),a(3)),s=a(6),h=a(1),u=(a(15),a(4));!function(e){e[e.Water=0]="Water",e[e.Earth=1]="Earth",e[e.Forest=2]="Forest",e[e.Desert=3]="Desert"}(n||(n={}));var d={id:1,name:"Toute eau",center:n.Water,edges:[n.Water,n.Water,n.Water,n.Water,n.Water,n.Water]},f={id:2,center:n.Water,edges:[n.Earth,n.Water,n.Water,n.Water,n.Water,n.Water]},g={id:3,center:n.Water,edges:[n.Earth,n.Earth,n.Water,n.Water,n.Water,n.Water]},E={id:4,center:n.Water,edges:[n.Earth,n.Water,n.Earth,n.Water,n.Water,n.Water]},W={id:5,center:n.Water,edges:[n.Earth,n.Water,n.Water,n.Earth,n.Water,n.Water]},m={id:6,center:n.Water,edges:[n.Earth,n.Earth,n.Earth,n.Water,n.Water,n.Water]},v={id:7,center:n.Water,edges:[n.Earth,n.Earth,n.Water,n.Earth,n.Water,n.Water]},y={id:8,center:n.Water,edges:[n.Earth,n.Earth,n.Water,n.Water,n.Earth,n.Water]},b={id:9,center:n.Water,edges:[n.Earth,n.Earth,n.Earth,n.Earth,n.Water,n.Water]},T={id:10,center:n.Water,edges:[n.Earth,n.Earth,n.Earth,n.Water,n.Earth,n.Water]},x={id:11,center:n.Water,edges:[n.Earth,n.Earth,n.Water,n.Earth,n.Earth,n.Water]},q={id:12,center:n.Water,edges:[n.Earth,n.Earth,n.Earth,n.Earth,n.Earth,n.Water]},p={id:13,center:n.Water,edges:[n.Earth,n.Earth,n.Earth,n.Earth,n.Earth,n.Earth]},w={id:14,name:"Toute eau simple",center:n.Water},O={id:101,name:"Ilot central",center:n.Earth,edges:[n.Water,n.Water,n.Water,n.Water,n.Water,n.Water]},j={id:102,center:n.Earth,edges:[n.Earth,n.Water,n.Water,n.Water,n.Water,n.Water]},M={id:103,center:n.Earth,edges:[n.Earth,n.Earth,n.Water,n.Water,n.Water,n.Water]},S={id:104,center:n.Earth,edges:[n.Earth,n.Water,n.Earth,n.Water,n.Water,n.Water]},P={id:105,center:n.Earth,edges:[n.Earth,n.Water,n.Water,n.Earth,n.Water,n.Water]},k={id:106,center:n.Earth,edges:[n.Earth,n.Earth,n.Earth,n.Water,n.Water,n.Water]},C={id:107,center:n.Earth,edges:[n.Earth,n.Earth,n.Water,n.Earth,n.Water,n.Water]},z={id:108,center:n.Earth,edges:[n.Earth,n.Earth,n.Water,n.Water,n.Earth,n.Water]},I={id:109,center:n.Earth,edges:[n.Earth,n.Earth,n.Earth,n.Earth,n.Water,n.Water]},N={id:110,center:n.Earth,edges:[n.Earth,n.Earth,n.Earth,n.Water,n.Earth,n.Water]},D={id:111,center:n.Earth,edges:[n.Earth,n.Earth,n.Water,n.Earth,n.Earth,n.Water]},A={id:112,center:n.Earth,edges:[n.Earth,n.Earth,n.Earth,n.Earth,n.Earth,n.Water]},R={id:113,name:"Toute terre",center:n.Earth},U=["#7dd1ff","#a65a35"],B={tiles:[{tile:d,quantity:3},{tile:w,quantity:1},{tile:f,quantity:1},{tile:g,quantity:1},{tile:E,quantity:1},{tile:W,quantity:1},{tile:m,quantity:1},{tile:v,quantity:1},{tile:y,quantity:1},{tile:b,quantity:1},{tile:T,quantity:1},{tile:x,quantity:1},{tile:q,quantity:1},{tile:p,quantity:1},{tile:O,quantity:3},{tile:j,quantity:1},{tile:M,quantity:1},{tile:S,quantity:1},{tile:P,quantity:1},{tile:k,quantity:1},{tile:C,quantity:1},{tile:z,quantity:1},{tile:I,quantity:1},{tile:N,quantity:1},{tile:D,quantity:1},{tile:A,quantity:1},{tile:R,quantity:1}]};function F(e,t){if(e.length>t)e.unshift.apply(e,Object(c.a)(e.splice(-t)));else for(var a=0;a<t;)e.unshift(e.splice(-1)),a++;return e}var H=Math.cos(Math.PI/6);function J(e,t,a,n,r){if(n)if(n.edges){var i=a/3,l=t.x,o=t.y,c=a;e.beginPath(),e.moveTo(l-c*H,o-.5*c),e.lineTo(l-c*H,o+.5*c),e.lineTo(l-i*H,o+.5*i),e.lineTo(l-i*H,o-.5*i),e.closePath(),e.fillStyle=r[n.edges[0]],e.fill(),e.beginPath(),e.moveTo(l-c*H,o+.5*c),e.lineTo(l,o+c),e.lineTo(l,o+i),e.lineTo(l-i*H,o+.5*i),e.closePath(),e.fillStyle=r[n.edges[1]],e.fill(),e.beginPath(),e.moveTo(l,o+c),e.lineTo(l+c*H,o+.5*c),e.lineTo(l+i*H,o+.5*i),e.lineTo(l,o+i),e.closePath(),e.fillStyle=r[n.edges[2]],e.fill(),e.beginPath(),e.moveTo(l+c*H,o+.5*c),e.lineTo(l+c*H,o-.5*c),e.lineTo(l+i*H,o-.5*i),e.lineTo(l+i*H,o+.5*i),e.closePath(),e.fillStyle=r[n.edges[3]],e.fill(),e.beginPath(),e.moveTo(l+c*H,o-.5*c),e.lineTo(l,o-c),e.lineTo(l,o-i),e.lineTo(l+i*H,o-.5*i),e.closePath(),e.fillStyle=r[n.edges[4]],e.fill(),e.beginPath(),e.lineTo(l,o-c),e.lineTo(l-c*H,o-.5*c),e.lineTo(l-i*H,o-.5*i),e.lineTo(l,o-i),e.closePath(),e.fillStyle=r[n.edges[5]],e.fill(),e.beginPath(),e.moveTo(l-i*H,o-.5*i),e.lineTo(l-i*H,o+.5*i),e.lineTo(l,o+i),e.lineTo(l+i*H,o+.5*i),e.lineTo(l+i*H,o-.5*i),e.lineTo(l,o-i),e.lineTo(l-i*H,o-.5*i),e.closePath(),e.fillStyle=r[n.center],e.fill()}else L(e,t,a,r[n.center]);else L(e,t,a,"red")}function L(e,t,a,n){var r=t.x,i=t.y,l=a;e.beginPath(),e.moveTo(r-l*H,i-.5*l),e.lineTo(r-l*H,i+.5*l),e.lineTo(r,i+l),e.lineTo(r+l*H,i+.5*l),e.lineTo(r+l*H,i-.5*l),e.lineTo(r,i-l),e.lineTo(r-l*H,i-.5*l),e.closePath(),e.fillStyle=n,e.fill()}function X(e,t){return{x:t*(Math.sqrt(3)*e.coordinates.q+Math.sqrt(3)/2*e.coordinates.r),y:t*(1.5*e.coordinates.r)}}function Y(e,t,a){var n={min:0,max:0},r=2+1.5*((n=e.tiles.reduce((function(e,t){return{min:Math.min(e.min,t.coordinates.r),max:Math.max(e.max,t.coordinates.r)}}),n)).max+-n.min+1+2-1),i=Math.floor(a/r),l=t/6/H;if(l=Math.floor(l),e.tiles.length>0){for(var o={min:Number.MAX_VALUE,max:Number.MIN_VALUE},c=0;c<e.tiles.length;c++){var s=X(e.tiles[c],10);o.min=Math.min(s.x,o.min),o.max=Math.max(s.x,o.max)}l=t/(2*((o.max-o.min+20*H)/(20*H)+2))/H,l=Math.floor(l)}return Math.min(i,l)}var K=function(e){var t=e.id,a=e.width,n=e.height,l=e.zIndex,o=e.nextTile,c=e.patterns,s=e.onClick,u=e.onWheel,d=e.playfield,f=e.tileSize,g=e.messages,E=Object(r.useState)({x:0,y:0}),W=Object(h.a)(E,2),m=W[0],v=W[1],y=Object(r.useState)(null),b=Object(h.a)(y,2),T=b[0],x=b[1];Object(r.useEffect)((function(){var e=document.getElementById(t).getContext("2d");e&&(e.font="24px Parisienne"),x(e)}),[t]),Object(r.useEffect)((function(){T&&m.x&&m.y&&(T.clearRect(0,0,a,n),o&&J(T,m,f,o,c))}),[m,a,n,T,o,c,f]),Object(r.useEffect)((function(){"foreground"===t&&T&&console.log("Pattern initialisation")}),[t,T]),Object(r.useEffect)((function(){d&&T&&(T.clearRect(0,0,a,n),function(e,t,a,n){for(var r=0;r<t.tiles.length;r++){var i=t.tiles[r],l=X(i,a);J(e,{x:e.canvas.width/2+l.x,y:e.canvas.height/2+l.y},a,i,n)}}(T,d,f,c))}),[d,T,a,n,f,c]),Object(r.useEffect)((function(){if(g&&T){var e=g.get("name"),t=g.get("remainingTiles");if(console.log("useEffect messages name",e),console.log("useEffect messages remainingTiles",t),T.clearRect(0,0,a,n),e&&T.fillText(e,0,30),t){var r=T.measureText(t);T.fillText(t,a-r.width,30)}}}),[g,T,a,n]);return i.a.createElement("canvas",{id:t,width:a,height:n,style:{border:"1px solid #000000",position:"absolute",zIndex:l},onMouseMove:function(e){e.preventDefault(),e.persist();var t={x:e.clientX,y:e.clientY};v(t)},onWheel:function(e){e.preventDefault(),e.persist(),u&&u(e.nativeEvent.deltaY)},onClick:function(e){e.preventDefault(),e.persist();var t={x:e.clientX,y:e.clientY};v(t),s&&s(t)}})},V=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],_=function(){var e=Object(r.useState)(0),t=Object(h.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(0),o=Object(h.a)(l,2),d=o[0],f=o[1],g=Object(r.useState)(25),E=Object(h.a)(g,2),W=E[0],m=E[1],v=Object(r.useState)(null),y=Object(h.a)(v,2),b=y[0],T=y[1],x=Object(r.useState)([]),q=Object(h.a)(x,2),p=q[0],w=q[1],O=Object(r.useState)({tiles:[]}),j=Object(h.a)(O,2),M=j[0],S=j[1],P=Object(r.useState)(null),k=Object(h.a)(P,2),C=k[0],z=k[1];Object(r.useEffect)((function(){console.log("Window initial size",window.innerWidth,window.innerHeight),n(window.innerWidth),f(window.innerHeight);var e=Y({tiles:[]},window.innerWidth,window.innerHeight);m(e)}),[]),Object(r.useEffect)((function(){console.log(B);var e=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[a],e[a]=n}return e}(B.tiles.map((function(e){for(var t=[],a=0;a<e.quantity;a++)t.push(e.tile.id);return t})).flat());console.log("shuffledDeck",e);var t=B.tiles.find((function(t){return t.tile.id===e[0]})),a=t?t.tile:null,n=new Map([["name","".concat(u.a," - ").concat(u.b)],["remainingTiles","".concat(e.length)]]);console.log("initial messages",n),T(a),z(n),w(e)}),[]),Object(r.useEffect)((function(){navigator.userAgent.toLowerCase().match(/mobile/i)?console.log("isMobile",!0):console.log("isMobile",!1),console.log("maxTouchPoints ?",navigator.maxTouchPoints)}),[]),Object(r.useEffect)((function(){var e=new Map([["name","".concat(u.a," - ").concat(u.b)],["remainingTiles","".concat(p.length)]]);z(e)}),[p.length]);return i.a.createElement(i.a.Fragment,null,a&&d&&i.a.createElement("div",{onKeyUpCapture:function(e){e.preventDefault(),e.persist(),console.log("handleKeyUpCapture event",e)}},i.a.createElement(K,{id:"background",width:a,height:d,zIndex:0,nextTile:null,patterns:U,onClick:null,onWheel:null,playfield:M,tileSize:W,messages:null}),i.a.createElement(K,{id:"texts",width:a,height:d,zIndex:1,nextTile:null,patterns:[],onClick:null,onWheel:null,playfield:null,tileSize:0,messages:C}),i.a.createElement(K,{id:"foreground",width:a,height:d,zIndex:2,nextTile:b,patterns:U,onClick:function(e){if(console.log("handleClick in app",e),b){var t={q:0,r:0};if(0!==M.tiles.length&&(t=function(e,t){var a=(Math.sqrt(3)/3*e.x-1/3*e.y)/t,n=2/3*e.y/t;return{q:Math.round(a),r:Math.round(n)}}({x:e.x-a/2,y:e.y-d/2},W)),void 0===M.tiles.find((function(e){return e.coordinates.q===t.q&&e.coordinates.r===t.r}))){if(0!==M.tiles.length){var n=0,r=!1,i=function(){var e={q:t.q+V[n].q,r:t.r+V[n].r};console.warn("checkCoordinates : ",n,e),r=void 0!==M.tiles.find((function(t){return t.coordinates.q===e.q&&t.coordinates.r===e.r})),console.warn("neighbor : ",n,r),n++};do{i()}while(!r&&n<V.length);if(!r)return void console.warn("No neighbor : ",t)}var l=Object(s.a)({},M,{tiles:[].concat(Object(c.a)(M.tiles),[Object(s.a)({},b,{coordinates:t})])}),o=Object(c.a)(p);if(o.length>0){var h;o.shift();var u=null===(h=B.tiles.find((function(e){return e.tile.id===o[0]})))||void 0===h?void 0:h.tile;T(u||null),console.log("newNextTile",u)}else T(null);console.log("newRemainingTiles",o),console.log("newPlayfield",l);var f=Y(l,a,d);m(f),S(l),w(o)}else console.warn("Already something here : ",t)}else console.log("No tile to add")},onWheel:function(e){if(console.log("handleWheel in app",e),b){var t=Object(s.a)({},b,{edges:F(b.edges,e>0?-1:1)});T(t)}else console.log("No tile to rotate")},playfield:null,tileSize:W,messages:null})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.a74b81f4.chunk.js.map