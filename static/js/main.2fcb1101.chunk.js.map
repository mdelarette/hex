{"version":3,"sources":["patterns/ocean.jpg","patterns/herbe.jpg","utils/useWindowSize.tsx","utils/debounce.tsx","utils/useImage.tsx","types/tile.tsx","data/tuile.tsx","helpers/deck.tsx","helpers/renderer.tsx","components/BackgroundCanvas.tsx","components/ForegroundCanvas.tsx","components/MessagesCanvas.tsx","components/TouchHelperCanvas.tsx","components/NextTileCanvas.tsx","helpers/drawMeeple.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["useWindowSize","isSSR","window","React","useState","windowInnerWidth","innerWidth","windowInnerHeight","innerHeight","windowSize","setWindowSize","useEffect","debouncedChangeWindowSize","func","timeoutId","waitMilliseconds","options","isImmediate","args","context","this","doLater","undefined","apply","shouldCallNow","clearTimeout","setTimeout","debounce","addEventListener","removeEventListener","defaultState","image","status","useImage","url","crossOrigin","res","setState","img","document","createElement","onload","onerror","src","FieldType","defaultPatterns","deck","Forest","Desert","tiles","tile","id","name","center","Water","quantity","edges","Earth","rotateArray","array","k","length","unshift","splice","i","cosPiSur6","Math","cos","PI","sinPiSur6","neighborhood","q","r","drawTile","ctx","position","size","patterns","innerLength","x","y","l","beginPath","moveTo","lineTo","closePath","fillStyle","fill","drawBeach","drawFilledHex","drawNextTile","shadowBlur","shadowColor","strokeStyle","stroke","drawShadowedHex","drawHex","start","end","save","lineWidth","lineCap","restore","pointy_hex_to_pixel","tuile","sqrt","coordinates","coordinates_to_pixel","computeOffset","canvasSize","tileSize","offset","width","height","mMx","min","Number","MAX_VALUE","max","MIN_VALUE","mMy","pos","computeSize","playField","remainingTile","minMax","remaingingTileAdjustment","nb","reduce","accumulator","coef","sizeForHeight","floor","sizeForWidth","mM","BackgroundCanvas","playfield","images","setContext","setPatterns","getElementById","getContext","newPatterns","p","createPattern","img2","clearRect","canvas","map","tuileInPlay","drawPlayFieldWithCoordinates","style","border","zIndex","ForegroundCanvas","nextTile","onClick","onWheel","mousePos","setMousePos","onMouseMove","event","preventDefault","persist","newMousePos","nativeEvent","offsetX","offsetY","deltaY","MessagesCanvas","messages","font","get","remainingTiles","measureText","fillText","TouchHelperCanvas","playfieldNeighborhood","forEach","neighbor","testCoordinates","find","n","push","playFieldNeighborhood","hasOwnProperty","tileCoordinates","drawPlayFieldNeighborhood","NextTileCanvas","color","translate","scale","lineJoin","miterLimit","bezierCurveTo","drawMeeple","useStyles","makeStyles","theme","createStyles","root","flexGrow","menuButton","marginRight","spacing","title","appBar","top","bottom","alignItems","grow","canvasesContainer","App","classes","navigator","maxTouchPoints","touchMode","anchorEl","setAnchorEl","setCanvasSize","setTileSize","setNextTile","setRemainingTiles","setPlayfield","Map","setMessages","setImages","blueImagePath","blueImage","blueImageStatus","brownImagePath","brownImage","brownImageStatus","newImages","console","log","initialWidth","initialHeight","topBar","scrollHeight","bottomBar","initialSize","versionFromStorage","localStorage","getItem","version","JSON","parse","playfieldStringFromStorage","remainingTilesStringFromStorage","playfieldFromStorage","remainingTilesFromStorage","newTileSize","handleNewGame","newWidth","newHeight","handleCtrlZ","newPlayfield","newNextTile","pop","newRemainingTiles","shuffledDeck","j","random","temp","shuffleArray","t","a","flat","newMessages","setItem","stringify","handleCloseMenu","handleWheel","delta","handleRotate","Fragment","className","onKeyUp","stopPropagation","key","ctrlKey","tabIndex","AppBar","Toolbar","IconButton","edge","aria-label","currentTarget","Typography","variant","Menu","keepMounted","open","Boolean","onClose","MenuItem","flattedDeck","canvasSizeRatio","nbLines","ratio","nbPerLine","ceil","newTileWithCoordinates","handleShowTiles","e","backgroundCanvas","location","href","toDataURL","handleCapture","point","round","pixel_to_pointy_hex","counter","checkCoordinates","nextTileCoordinates","shift","disabled","hostname","match","ReactDOM","render","StrictMode","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.2fcb1101.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/ocean.b8757f09.jpg\";","export default __webpack_public_path__ + \"static/media/herbe.45ccdaf8.jpg\";","// utils/useWindowSize.js\r\n\r\n// Original source and explaination: https://reedbarger.com/how-to-create-a-usewindowsize-react-hook/\r\n\r\n// Enhancement suggestion with debounce : https://www.pluralsight.com/guides/re-render-react-component-on-window-resize\r\n\r\nimport React from \"react\";\r\nimport { debounce } from \"./debounce\";\r\n\r\n\r\nexport default function useWindowSize() {\r\n  const isSSR = typeof window === \"undefined\";\r\n  const [windowSize, setWindowSize] = React.useState({\r\n    windowInnerWidth: isSSR ? 1200 : window.innerWidth,\r\n    windowInnerHeight: isSSR ? 800 : window.innerHeight,\r\n  });\r\n\r\n  React.useEffect(() => {\r\n\r\n    const debouncedChangeWindowSize = debounce(function changeWindowSize() {\r\n\r\n      setWindowSize({ windowInnerWidth: window.innerWidth, windowInnerHeight: window.innerHeight });\r\n\r\n    }, 250);\r\n\r\n\r\n    window.addEventListener(\"resize\", debouncedChangeWindowSize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"resize\", debouncedChangeWindowSize);\r\n    };\r\n  }, []);\r\n\r\n  return windowSize;\r\n}\r\n","/**\r\n * A function that emits a side effect and does not return anything.\r\n */\r\n\r\n // FORM here : https://github.com/chodorowicz/ts-debounce/blob/master/src/index.ts\r\n\r\nexport type Procedure = (...args: any[]) => void;\r\n\r\nexport type Options = {\r\n  isImmediate: boolean,\r\n}\r\n\r\nexport function debounce<F extends Procedure>(\r\n  func: F,\r\n  waitMilliseconds = 50,\r\n  options: Options = {\r\n    isImmediate: false\r\n  },\r\n): (this: ThisParameterType<F>, ...args: Parameters<F>) => void {\r\n  let timeoutId: ReturnType<typeof setTimeout> | undefined;\r\n\r\n  return function(this: ThisParameterType<F>, ...args: Parameters<F>) {\r\n    const context = this;\r\n\r\n    const doLater = function() {\r\n      timeoutId = undefined;\r\n      if (!options.isImmediate) {\r\n        func.apply(context, args);\r\n      }\r\n    }\r\n\r\n    const shouldCallNow = options.isImmediate && timeoutId === undefined;\r\n\r\n    if (timeoutId !== undefined) {\r\n      clearTimeout(timeoutId);\r\n    }\r\n\r\n    timeoutId = setTimeout(doLater, waitMilliseconds);\r\n\r\n    if (shouldCallNow) {\r\n      func.apply(context, args);\r\n    }\r\n  }\r\n}\r\n","\r\n// Original source : https://github.com/konvajs/use-image/blob/master/index.js\r\n\r\nimport React from \"react\";\r\n\r\n\r\ninterface MyImage {\r\n    image: HTMLImageElement | null;\r\n    status: string;\r\n}\r\n\r\nvar defaultState:MyImage = { image: null, status: 'loading' };\r\n\r\n\r\n\r\nexport default function useImage(url:string, crossOrigin?:string) {\r\n  var res = React.useState<MyImage>(defaultState);\r\n  var image = res[0].image;\r\n  var status = res[0].status;\r\n\r\n  var setState = res[1];\r\n\r\n  React.useEffect(\r\n    function () {\r\n      if (!url) return;\r\n      var img = document.createElement('img');\r\n\r\n      function onload() {\r\n        setState({ image: img, status: 'loaded' });\r\n      }\r\n\r\n      function onerror() {\r\n        setState({ image: null, status: 'failed' });\r\n      }\r\n\r\n      img.addEventListener('load', onload);\r\n      img.addEventListener('error', onerror);\r\n      crossOrigin && (img.crossOrigin = crossOrigin);\r\n      img.src = url;\r\n\r\n      return function cleanup() {\r\n        img.removeEventListener('load', onload);\r\n        img.removeEventListener('error', onerror);\r\n        setState(defaultState);\r\n      };\r\n    },\r\n    [url, crossOrigin, setState]\r\n  );\r\n\r\n  // return array because it it better to use in case of several useImage hooks\r\n  // const [background, backgroundStatus] = useImage(url1);\r\n  // const [patter] = useImage(url2);\r\n  return [image, status];\r\n};\r\n","export enum FieldType {\r\n    Water = 0,\r\n    Earth,\r\n    Forest,\r\n    Desert\r\n  }\r\n\r\n\r\nexport interface Coordinates {\r\n    q: number;\r\n    r: number;\r\n}\r\nexport interface Point {\r\n    x: number;\r\n    y: number;\r\n}\r\nexport interface Dimension {\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport interface Tile {\r\n    id: number;\r\n    name?: string;\r\n\r\n    center: FieldType;\r\n    edges?: FieldType[];\r\n}\r\n\r\nexport interface TileWithCoordinates extends Tile {\r\n    coordinates: Coordinates;\r\n}\r\nexport interface QuantifiedTile {\r\n    tile:Tile;\r\n    quantity:number;\r\n}\r\nexport interface Deck {\r\n    tiles: QuantifiedTile[];\r\n}\r\n\r\nexport interface Playfield {\r\n    tiles: TileWithCoordinates[];\r\n}","\r\nimport { Tile, FieldType, Deck } from '../types/tile';\r\n\r\n// Water = 0,\r\n// Earth,\r\n// Forest,\r\n// Desert\r\nexport const defaultPatterns = ['#7dd1ff', '#a65a35', 'green', 'yellow'];\r\n\r\nconst tile_1002: Tile = {\r\n  id: -2,\r\n  name: \"Forest\",\r\n  center: FieldType.Forest\r\n};\r\nconst tile_1001: Tile = {\r\n  id: -1,\r\n  name: \"Desert\",\r\n  center: FieldType.Desert\r\n};\r\n\r\nconst tile_001: Tile = {\r\n  id: 1,\r\n  name: \"Toute eau\",\r\n  center: FieldType.Water\r\n};\r\n\r\nconst tuile2: Tile = {\r\n  id: 2,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile3: Tile = {\r\n  id: 3,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile4: Tile = {\r\n  id: 4,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile5: Tile = {\r\n  id: 5,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Earth, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile6: Tile = {\r\n  id: 6,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile7: Tile = {\r\n  id: 7,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile8: Tile = {\r\n  id: 8,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile9: Tile = {\r\n  id: 9,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile10: Tile = {\r\n  id: 10,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile11: Tile = {\r\n  id: 11,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile12: Tile = {\r\n  id: 12,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile13: Tile = {\r\n  id: 13,\r\n  center: FieldType.Water,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth],\r\n};\r\n\r\n\r\nconst tuile101: Tile = {\r\n  id: 101,\r\n  name: \"Ilot central\",\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile102: Tile = {\r\n  id: 102,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile103: Tile = {\r\n  id: 103,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile104: Tile = {\r\n  id: 104,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile105: Tile = {\r\n  id: 105,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Earth, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile106: Tile = {\r\n  id: 106,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile107: Tile = {\r\n  id: 107,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile108: Tile = {\r\n  id: 108,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile109: Tile = {\r\n  id: 109,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Water],\r\n};\r\n\r\nconst tuile110: Tile = {\r\n  id: 110,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile111: Tile = {\r\n  id: 111,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Water, FieldType.Earth, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile112: Tile = {\r\n  id: 112,\r\n  center: FieldType.Earth,\r\n  edges: [FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Earth, FieldType.Water],\r\n};\r\n\r\nconst tuile113: Tile = {\r\n  id: 113,\r\n  name: \"Toute terre\",\r\n  center: FieldType.Earth\r\n};\r\n\r\n\r\n\r\n\r\nconst deck:Deck = {tiles:[\r\n\r\n  // { tile: tile_1002, quantity: 4 },\r\n  // { tile: tile_1001, quantity: 4 },\r\n\r\n\r\n  \r\n  \r\n\r\n  { tile: tile_001, quantity: 3 },\r\n  { tile: tuile2, quantity: 1 },\r\n  { tile: tuile3, quantity: 1 },\r\n  { tile: tuile4, quantity: 1 },\r\n  { tile: tuile5, quantity: 1 },\r\n  { tile: tuile6, quantity: 1 },\r\n  { tile: tuile7, quantity: 1 },\r\n  { tile: tuile8, quantity: 1 },\r\n  { tile: tuile9, quantity: 1 },\r\n  { tile: tuile10, quantity: 1 },\r\n  { tile: tuile11, quantity: 1 },\r\n  { tile: tuile12, quantity: 1 },\r\n  { tile: tuile13, quantity: 1 },\r\n\r\n  { tile: tuile101, quantity: 3 },\r\n  { tile: tuile102, quantity: 1 },\r\n  { tile: tuile103, quantity: 1 },\r\n  { tile: tuile104, quantity: 1 },\r\n  { tile: tuile105, quantity: 1 },\r\n  { tile: tuile106, quantity: 1 },\r\n  { tile: tuile107, quantity: 1 },\r\n  { tile: tuile108, quantity: 1 },\r\n  { tile: tuile109, quantity: 1 },\r\n  { tile: tuile110, quantity: 1 },\r\n  { tile: tuile111, quantity: 1 },\r\n  { tile: tuile112, quantity: 1 },\r\n  { tile: tuile113, quantity: 1 },\r\n\r\n]};\r\n\r\nexport default deck;\r\n","export function shuffleArray(array:any) {\r\n  for (var i = array.length - 1; i > 0; i--) {\r\n    // Generate random number\r\n    var j = Math.floor(Math.random() * (i + 1));\r\n\r\n    var temp = array[i];\r\n    array[i] = array[j];\r\n    array[j] = temp;\r\n  }\r\n\r\n  return array;\r\n}\r\n\r\n// https://medium.com/javascript-in-plain-english/algorithms-101-rotate-array-in-javascript-three-solutions-260fbc923b64\r\nexport function rotateArray(array:any, k:number) {\r\n  if (array.length > k) {\r\n    array.unshift(...array.splice(-k));\r\n  } else {\r\n    let i = 0;\r\n    while (i < k) {\r\n      array.unshift(array.splice(-1));\r\n      i++;\r\n    }\r\n  }\r\n  return array;\r\n}\r\n","\r\nimport { Tile, Point, Dimension, TileWithCoordinates, Coordinates, Playfield } from '../types/tile';\r\n\r\nconst cosPiSur6 = Math.cos(Math.PI / 6);\r\nconst sinPiSur6 = 1 / 2; // (1/2)\r\n\r\n\r\nexport const neighborhood = [\r\n\t{q: +1, r: 0},\t{q: +1, r: -1},\t{q: 0, r: -1}, {q: -1, r: 0}, {q: -1, r: +1}, {q: 0, r: +1},\r\n];\r\n\r\nexport function drawTile(ctx:CanvasRenderingContext2D , position:Point, size:number, tile:Tile, patterns:(string|CanvasPattern)[]|null) {\r\n  // console.log(\"drawTuile\", tuile, \" at \", x , \"x\", y);\r\n\r\n  if(!tile)\r\n  {\r\n    drawFilledHex(ctx, position, size, \"red\");\r\n    return;\r\n  }\r\n\r\n  if(!tile.edges)\r\n  {\r\n    drawFilledHex(ctx, position, size, patterns ? patterns[tile.center] : \"red\");\r\n    return;\r\n  }\r\n\r\n  const innerLength = size / 3;\r\n\r\n  const x = position.x;\r\n  const y = position.y;\r\n  const l = size;\r\n  \r\n\r\n\r\n  // Gauche\r\n  ctx.beginPath();\r\n  ctx.moveTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x - l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x - innerLength * cosPiSur6, y + innerLength * sinPiSur6);\r\n  ctx.lineTo(x - innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.closePath();\r\n  ctx.fillStyle = patterns ? patterns[tile.edges[0]] : \"red\";  \r\n  ctx.fill();\r\n\r\n  // Bas gauche\r\n  ctx.beginPath();\r\n  ctx.moveTo(x - l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x, y + l);\r\n  ctx.lineTo(x, y + innerLength);\r\n  ctx.lineTo(x - innerLength * cosPiSur6, y + innerLength * sinPiSur6);\r\n  ctx.closePath();\r\n  ctx.fillStyle = patterns ? patterns[tile.edges[1]] : \"red\";\r\n  ctx.fill();\r\n\r\n  // Bas droit\r\n  ctx.beginPath();\r\n  ctx.moveTo(x, y + l);\r\n  ctx.lineTo(x + l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x + innerLength * cosPiSur6, y + innerLength * sinPiSur6);\r\n  ctx.lineTo(x, y + innerLength);\r\n  ctx.closePath();\r\n  ctx.fillStyle = patterns ? patterns[tile.edges[2]] : \"red\";\r\n  ctx.fill();\r\n\r\n  // Droite\r\n  ctx.beginPath();\r\n  ctx.moveTo(x + l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x + l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x + innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.lineTo(x + innerLength * cosPiSur6, y + innerLength * sinPiSur6);\r\n  ctx.closePath();\r\n  ctx.fillStyle = patterns ? patterns[tile.edges[3]] : \"red\";\r\n  ctx.fill();\r\n\r\n  // Haut droit\r\n  ctx.beginPath();\r\n  ctx.moveTo(x + l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x, y - l);\r\n  ctx.lineTo(x, y - innerLength);\r\n  ctx.lineTo(x + innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.closePath();\r\n  ctx.fillStyle = patterns ? patterns[tile.edges[4]] : \"red\";\r\n  ctx.fill();\r\n\r\n  // Haut gauche\r\n  ctx.beginPath();\r\n  ctx.lineTo(x, y - l);\r\n  ctx.lineTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x - innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.lineTo(x, y - innerLength);\r\n  ctx.closePath();\r\n  ctx.fillStyle = patterns ? patterns[tile.edges[5]] : \"red\";\r\n  ctx.fill();\r\n\r\n  // Hexagone central\r\n  ctx.beginPath();\r\n  ctx.moveTo(x - innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.lineTo(x - innerLength * cosPiSur6, y + innerLength * sinPiSur6);\r\n  ctx.lineTo(x, y + innerLength);\r\n  ctx.lineTo(x + innerLength * cosPiSur6, y + innerLength * sinPiSur6);\r\n  ctx.lineTo(x + innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.lineTo(x, y - innerLength);\r\n  ctx.lineTo(x - innerLength * cosPiSur6, y - innerLength * sinPiSur6);\r\n  ctx.closePath();\r\n\r\n  ctx.fillStyle = patterns ? patterns[tile.center] : \"red\";\r\n\r\n  ctx.fill();\r\n\r\n\r\n  // Dessin des \"plages\"\r\n  if(tile.edges[0] !== tile.edges[1])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x - l * cosPiSur6, y: y + l * sinPiSur6},\r\n      { x: x - innerLength * cosPiSur6, y: y + innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  \r\n  if(tile.edges[1] !== tile.edges[2])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x, y: y + l},\r\n      { x: x, y: y + innerLength},\r\n      size\r\n    );\r\n  }\r\n\r\n  if(tile.edges[2] !== tile.edges[3])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x + l * cosPiSur6, y: y + l * sinPiSur6},\r\n      { x: x + innerLength * cosPiSur6, y: y + innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n\r\n  if(tile.edges[3] !== tile.edges[4])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x + l * cosPiSur6, y: y - l * sinPiSur6},\r\n      { x: x + innerLength * cosPiSur6, y: y - innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  if(tile.edges[4] !== tile.edges[5])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x, y: y - l},\r\n      { x: x, y: y - innerLength},\r\n      size\r\n    );\r\n  }\r\n\r\n  if(tile.edges[5] !== tile.edges[0])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x - l * cosPiSur6, y: y - l * sinPiSur6},\r\n      { x: x - innerLength * cosPiSur6, y: y - innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  \r\n  // Dessin des \"plages centrales\"\r\n  if(tile.center !== tile.edges[0])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x - innerLength * cosPiSur6, y: y + innerLength * sinPiSur6},\r\n      { x: x - innerLength * cosPiSur6, y: y - innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  if(tile.center !== tile.edges[1])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x, y: y + innerLength},\r\n      { x: x - innerLength * cosPiSur6, y: y + innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  if(tile.center !== tile.edges[2])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x + innerLength * cosPiSur6, y: y + innerLength * sinPiSur6},\r\n      { x: x, y: y + innerLength},\r\n      size\r\n    );\r\n  }\r\n  if(tile.center !== tile.edges[3])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x + innerLength * cosPiSur6, y: y - innerLength * sinPiSur6},\r\n      { x: x + innerLength * cosPiSur6, y: y + innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  if(tile.center !== tile.edges[4])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x, y: y - innerLength},\r\n      { x: x + innerLength * cosPiSur6, y: y - innerLength * sinPiSur6},\r\n      size\r\n    );\r\n  }\r\n  if(tile.center !== tile.edges[5])\r\n  {\r\n    drawBeach(\r\n      ctx,\r\n      { x: x - innerLength * cosPiSur6, y: y - innerLength * sinPiSur6},\r\n      { x: x, y: y - innerLength},\r\n      size\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport function drawNextTile(ctx:CanvasRenderingContext2D , position:Point, size:number, tile:Tile, patterns:(string|CanvasPattern)[]|null) {\r\n  drawShadowedHex(ctx, position, size);\r\n  drawTile(ctx , position, size, tile, patterns);\r\n}\r\n\r\n// function drawCircle(ctx, x, y, l) {\r\n//   ctx.beginPath();\r\n//   ctx.arc(x, y, l, 0, 2 * Math.PI);\r\n//   ctx.stroke();\r\n// }\r\n\r\nfunction drawHex(ctx:CanvasRenderingContext2D, position:Point, size:number) {\r\n  \r\n  const x = position.x;\r\n  const y = position.y;\r\n  const l = size;\r\n\r\n  ctx.beginPath();\r\n  ctx.moveTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x - l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x, y + l);\r\n  ctx.lineTo(x + l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x + l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x, y - l);\r\n  ctx.lineTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.closePath();\r\n\r\n  ctx.strokeStyle = \"black\";\r\n  ctx.stroke();\r\n}\r\n\r\nfunction drawShadowedHex(ctx:CanvasRenderingContext2D, position:Point, size:number) {\r\n  \r\n  const x = position.x;\r\n  const y = position.y;\r\n  const l = size;\r\n\r\n  ctx.beginPath();\r\n  ctx.moveTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x - l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x, y + l);\r\n  ctx.lineTo(x + l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x + l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x, y - l);\r\n  ctx.lineTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.closePath();\r\n\r\n  ctx.shadowBlur = 20;\r\n  ctx.shadowColor = \"black\";\r\n  ctx.strokeStyle = \"black\";\r\n  ctx.stroke();\r\n  ctx.fillStyle = \"\";\r\n  ctx.fill();\r\n  ctx.shadowBlur = 0;\r\n  \r\n}\r\n\r\nfunction drawFilledHex(ctx:CanvasRenderingContext2D, position:Point, size:number, fillStyle:string|CanvasPattern) {\r\n\r\n  const x = position.x;\r\n  const y = position.y;\r\n  const l = size;\r\n\r\n  ctx.beginPath();\r\n\r\n  ctx.moveTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x - l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x, y + l);\r\n  ctx.lineTo(x + l * cosPiSur6, y + l * sinPiSur6);\r\n  ctx.lineTo(x + l * cosPiSur6, y - l * sinPiSur6);\r\n  ctx.lineTo(x, y - l);\r\n  ctx.lineTo(x - l * cosPiSur6, y - l * sinPiSur6);\r\n\r\n  ctx.closePath();\r\n\r\n  ctx.fillStyle = fillStyle;\r\n  ctx.fill();\r\n}\r\n\r\n\r\nexport function drawBeach(ctx:CanvasRenderingContext2D, start:Point, end:Point, size:number)\r\n{\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.lineTo(start.x, start.y);\r\n    ctx.lineTo(end.x, end.y);\r\n    ctx.closePath();\r\n    ctx.strokeStyle = \"#c2b280\";    \r\n    ctx.lineWidth = size/12;\r\n    ctx.lineCap = 'round';\r\n    ctx.stroke();\r\n    ctx.restore();\r\n}\r\n\r\n\r\n// https://www.redblobgames.com/grids/hexagons/#pixel-to-hex\r\nexport function pixel_to_pointy_hex(point:Point, size:number) {\r\n  var q = ((Math.sqrt(3) / 3) * point.x - (1 / 3) * point.y) / size;\r\n  var r = ((2 / 3) * point.y) / size;\r\n\r\n  return { q: Math.round(q), r: Math.round(r) };\r\n  // {\r\n  // q: Math.round(q),\r\n  // r: Math.round(r)\r\n  // };\r\n}\r\n\r\n// https://www.redblobgames.com/grids/hexagons/#neighbors-axial\r\n// https://www.redblobgames.com/grids/hexagons/#hex-to-pixel-axial\r\n\r\nfunction pointy_hex_to_pixel(tuile:TileWithCoordinates, size:number) {\r\n  var x =\r\n    size *\r\n    (Math.sqrt(3) * tuile.coordinates.q +\r\n      (Math.sqrt(3) / 2) * tuile.coordinates.r);\r\n  var y = size * ((3 / 2) * tuile.coordinates.r);\r\n  return { x, y };\r\n}\r\nfunction coordinates_to_pixel(coordinates:Coordinates, size:number) {\r\n  var x =\r\n    size *\r\n    (Math.sqrt(3) * coordinates.q +\r\n      (Math.sqrt(3) / 2) * coordinates.r);\r\n  var y = size * ((3 / 2) * coordinates.r);\r\n  return { x, y };\r\n}\r\n\r\nexport function computeOffset(canvasSize:Dimension, coordinates:Coordinates[], tileSize:number) {\r\n\r\n  const offset:Point = { x: canvasSize.width / 2, y:canvasSize.height / 2 };\r\n\r\n  if(coordinates.length > 0)\r\n  {\r\n    let mMx = { min: Number.MAX_VALUE, max: Number.MIN_VALUE};\r\n    let mMy = { min: Number.MAX_VALUE, max: Number.MIN_VALUE};\r\n    for(let i = 0; i<coordinates.length; i++ )\r\n    {\r\n      let pos = coordinates_to_pixel(coordinates[i], tileSize);\r\n      mMx.min = Math.min(pos.x, mMx.min);\r\n      mMx.max = Math.max(pos.x, mMx.max);\r\n      mMy.min = Math.min(pos.y, mMy.min);\r\n      mMy.max = Math.max(pos.y, mMy.max);\r\n    }\r\n\r\n    offset.x = offset.x - ((mMx.max + mMx.min)/2);\r\n    offset.y = offset.y - ((mMy.max + mMy.min)/2);\r\n  } \r\n  return offset;\r\n}\r\n\r\nexport function drawPlayFieldWithCoordinates(ctx:CanvasRenderingContext2D, playField:Playfield, tileSize:number, patterns:(string|CanvasPattern)[]) {\r\n\r\n  const offset:Point = computeOffset({width: ctx.canvas.width, height: ctx.canvas.height}, playField.tiles.map(tile => tile.coordinates), tileSize);\r\n\r\n\r\n  for (let i = 0; i < playField.tiles.length; i++) {\r\n    let tuileInPlay = playField.tiles[i];\r\n    var pos = pointy_hex_to_pixel(tuileInPlay, tileSize);\r\n    drawTile(\r\n      ctx,\r\n      { x: offset.x + pos.x, y:offset.y + pos.y},\r\n      tileSize,\r\n      tuileInPlay,\r\n      patterns\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\nexport function drawPlayFieldNeighborhood(ctx:CanvasRenderingContext2D, playFieldNeighborhood:Coordinates[], tileSize:number, nextTile:Tile|TileWithCoordinates|null, patterns:(string|CanvasPattern)[]|null) {\r\n  \r\n  const offset:Point = computeOffset({width: ctx.canvas.width, height: ctx.canvas.height}, playFieldNeighborhood, tileSize);\r\n  \r\n  for (let i = 0; i < playFieldNeighborhood.length; i++) {\r\n    let coordinates = playFieldNeighborhood[i];\r\n    var pos = coordinates_to_pixel(coordinates, tileSize);\r\n    drawHex(\r\n      ctx,\r\n      { x: offset.x + pos.x, y:offset.y + pos.y},\r\n      tileSize\r\n    );\r\n    if(nextTile && !nextTile.hasOwnProperty(\"coordinates\"))\r\n    {\r\n      drawNextTile(\r\n        ctx,\r\n        { x: offset.x + pos.x, y:offset.y + pos.y},\r\n        tileSize*0.75,\r\n        nextTile,\r\n        patterns\r\n      );\r\n\r\n    }    \r\n    if(nextTile && nextTile.hasOwnProperty(\"coordinates\"))\r\n    {\r\n      let tileCoordinates = (nextTile as TileWithCoordinates).coordinates;\r\n  \r\n      if(tileCoordinates.q === coordinates.q && tileCoordinates.r === coordinates.r)\r\n      {\r\n        drawNextTile(\r\n          ctx,\r\n          { x: offset.x + pos.x, y:offset.y + pos.y},\r\n          tileSize,\r\n          nextTile,\r\n          patterns\r\n        );\r\n  \r\n      }\r\n\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport function computeSize(playField:Playfield, canvasSize:{width:number, height:number}, remainingTile:boolean = true) {\r\n  \r\n  // Size for height\r\n  let minMax = { min: 0, max: 0};\r\n  \r\n  let remaingingTileAdjustment = remainingTile ? 2 : 0;\r\n\t\r\n\tminMax = playField.tiles.reduce((accumulator, tuile) => {return { min: Math.min(accumulator.min, tuile.coordinates.r), max: Math.max(accumulator.max, tuile.coordinates.r)};}, minMax);\r\n\t\t\r\n\tlet nb = minMax.max + (-minMax.min) + 1 + remaingingTileAdjustment;\r\n\r\n\t// let coef = 2 + (nb-1) * (1 + Math.sin(Math.PI/6));\r\n  let coef = 2 + (nb-1) * 1.5;\r\n  \r\n  let sizeForHeight = Math.floor(canvasSize.height/coef);\r\n\r\n  // Size for width\r\n  let sizeForWidth = canvasSize.width / 6 / cosPiSur6;\r\n  sizeForWidth = Math.floor(sizeForWidth);\r\n\r\n  if(playField.tiles.length > 0)\r\n  {\r\n    let mM = { min: Number.MAX_VALUE, max: Number.MIN_VALUE};\r\n    for(let i = 0; i<playField.tiles.length; i++ )\r\n    {\r\n      let pos = pointy_hex_to_pixel(playField.tiles[i], 10); // size does not matter\r\n      mM.min = Math.min(pos.x, mM.min);\r\n      mM.max = Math.max(pos.x, mM.max);\r\n    }\r\n    let nb = (mM.max - mM.min + 2 * 10 * cosPiSur6)/(2 * 10 * cosPiSur6) + remaingingTileAdjustment;\r\n    sizeForWidth = canvasSize.width / (nb * 2) / cosPiSur6;\r\n    sizeForWidth = Math.floor(sizeForWidth);\r\n  }\r\n\treturn Math.min(sizeForHeight, sizeForWidth);\r\n}","import React from 'react';\r\n\r\nimport {useState, useEffect} from 'react';\r\n\r\n\r\nimport { Playfield, Dimension, FieldType } from '../types/tile';\r\n\r\nimport {drawPlayFieldWithCoordinates} from '../helpers/renderer';\r\n\r\n\r\nconst BackgroundCanvas: React.FC<{size:Dimension, defaultPatterns: string[], playfield:Playfield, tileSize:number, images:(HTMLImageElement | null)[]}> = ({size, defaultPatterns, playfield, tileSize, images}) => {\r\n       \r\n    const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\r\n\r\n    const [patterns, setPatterns] = useState<(string|CanvasPattern)[]>(defaultPatterns);\r\n\r\n    useEffect(() => {\r\n        let c:HTMLCanvasElement|null = document.getElementById(\"background\") as HTMLCanvasElement;        \r\n        let ctx = c.getContext(\"2d\");\r\n        setContext(ctx);\r\n    }, []);\r\n    \r\n    useEffect(() => {\r\n        if(context)\r\n        {\r\n            let newPatterns = [...patterns];\r\n\r\n            let img = images[FieldType.Earth];\r\n            if(img)\r\n            {\r\n                let p = context.createPattern(img, 'repeat');\r\n                if(p)\r\n                {\r\n                    newPatterns[FieldType.Earth] = p;\r\n\r\n                }\r\n            }\r\n\r\n\r\n            let img2 = images[FieldType.Water];\r\n            if(img2)\r\n            {\r\n                let p = context.createPattern(img2, 'repeat');\r\n                if(p)\r\n                {\r\n                    newPatterns[FieldType.Water] = p;\r\n                }\r\n            }\r\n            setPatterns(newPatterns);\r\n\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [images]); // context, patterns\r\n\r\n\r\n    // useEffect(() => {\r\n    //     console.log('Canvas size', width, height);\r\n    // }, [width, height]);\r\n       \r\n    \r\n\r\n    useEffect(() => {       \r\n        if(playfield && context)\r\n        {\r\n            context.clearRect(0,0,size.width,size.height);\r\n            drawPlayFieldWithCoordinates(context, playfield, tileSize, patterns );\r\n            \r\n        } \r\n\r\n    }, [playfield, context, size, tileSize, patterns]);\r\n    \r\n\r\n\r\n    return (\r\n        <canvas\r\n            id={\"background\"}\r\n            width={size.width} \r\n            height={size.height} \r\n            style={{border:\"1px solid #000000\", position: \"absolute\", zIndex: 0}}\r\n        />\r\n    );\r\n}\r\n\r\n  \r\nexport default BackgroundCanvas;","import React from 'react';\r\n\r\nimport {useState, useEffect} from 'react';\r\n\r\n\r\nimport { Tile, Dimension, FieldType } from '../types/tile';\r\nimport { drawNextTile } from '../helpers/renderer';\r\n\r\n// import { drawMeeple } from '../helpers/drawMeeple';\r\n\r\nconst ForegroundCanvas: React.FC<{size:Dimension, nextTile: Tile | null, defaultPatterns: string[], onClick:Function | null, onWheel:Function | null, tileSize:number, images:(HTMLImageElement | null)[]}> = ({size, nextTile, defaultPatterns, onClick, onWheel, tileSize, images}) => {\r\n    \r\n    const [mousePos, setMousePos] = useState({x: 0, y: 0});\r\n    \r\n    const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\r\n\r\n    const [patterns, setPatterns] = useState<(string|CanvasPattern)[]>(defaultPatterns);\r\n\r\n    useEffect(() => {\r\n        let c:HTMLCanvasElement|null = document.getElementById(\"foreground\") as HTMLCanvasElement;        \r\n        let ctx = c.getContext(\"2d\");\r\n        setContext(ctx);\r\n    }, []);\r\n    \r\n    useEffect(() => {\r\n        if(context)\r\n        {\r\n            let newPatterns = [...patterns];\r\n\r\n            let img = images[FieldType.Earth];\r\n            if(img)\r\n            {\r\n                let p = context.createPattern(img, 'repeat');\r\n                if(p)\r\n                {\r\n                    newPatterns[FieldType.Earth] = p;\r\n\r\n                }\r\n            }\r\n\r\n\r\n            let img2 = images[FieldType.Water];\r\n            if(img2)\r\n            {\r\n                let p = context.createPattern(img2, 'repeat');\r\n\r\n                if(p)\r\n                {\r\n                    newPatterns[FieldType.Water] = p;\r\n                }\r\n            }\r\n            setPatterns(newPatterns);\r\n\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [images]); // context, patterns\r\n\r\n\r\n    // useEffect(() => {\r\n    //     console.log('Canvas size', width, height);\r\n    // }, [width, height]);\r\n    \r\n    \r\n    useEffect(() => {        \r\n        if(context && mousePos.x && mousePos.y)\r\n        {\r\n            context.clearRect(0,0,size.width,size.height);\r\n            if(nextTile)\r\n            {\r\n                drawNextTile(context, mousePos, tileSize, nextTile, patterns);\r\n\r\n                // drawMeeple(context, mousePos, tileSize, \"green\");\r\n\r\n            }\r\n        }\r\n\r\n    }, [mousePos, size, context, nextTile, patterns, tileSize]);\r\n\r\n    \r\n    // useEffect(() => {        \r\n    //     if(context && mousePos.x && mousePos.y)\r\n    //     {\r\n    //         context.clearRect(0,0,size.width,size.height);\r\n    //         if(nextTile)\r\n    //         {\r\n    //             // drawTile(context, mousePos, tileSize, nextTile, patterns);\r\n    //             drawNextTile(context, mousePos, tileSize, nextTile, patterns);\r\n    //         }\r\n    //     }\r\n\r\n    // }, [context, patterns]);\r\n       \r\n\r\n\r\n    const handleMouseMove = (event:React.MouseEvent<HTMLCanvasElement, MouseEvent>) => {\r\n        event.preventDefault();\r\n        event.persist();\r\n        \r\n        let newMousePos = {x: event.nativeEvent.offsetX, y: event.nativeEvent.offsetY};\r\n\r\n        setMousePos(newMousePos);\r\n    }\r\n    \r\n    const handleClick = (event:React.MouseEvent<HTMLCanvasElement, MouseEvent>) => {\r\n        event.preventDefault();\r\n        event.persist();\r\n                \r\n        let newMousePos = {x: event.nativeEvent.offsetX, y: event.nativeEvent.offsetY};\r\n        setMousePos(newMousePos);\r\n        if(onClick)\r\n        {\r\n            onClick(newMousePos);\r\n        }\r\n    }\r\n    \r\n    const handleWheel = (event:React.MouseEvent<HTMLCanvasElement, WheelEvent>) => {\r\n        event.preventDefault();\r\n        event.persist();\r\n        if(onWheel)\r\n        {\r\n            onWheel(event.nativeEvent.deltaY);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <canvas\r\n            id={\"foreground\"} \r\n            width={size.width} \r\n            height={size.height} \r\n            style={{border:\"1px solid #000000\", position: \"absolute\", zIndex: 3}}\r\n\r\n\r\n            onMouseMove={handleMouseMove}\r\n            onWheel={handleWheel}\r\n            onClick={handleClick}\r\n        />\r\n    );\r\n}\r\n\r\n  \r\nexport default ForegroundCanvas;","import React from 'react';\r\n\r\nimport {useState, useEffect} from 'react';\r\n\r\nimport { Dimension } from '../types/tile';\r\n\r\nconst MessagesCanvas: React.FC<{size:Dimension, messages: Map<string,string> | null}> = ({size, messages}) => {\r\n    \r\n    const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\r\n\r\n    useEffect(() => {\r\n        let c:HTMLCanvasElement|null = document.getElementById(\"messages\") as HTMLCanvasElement;        \r\n        let ctx = c.getContext(\"2d\");\r\n        if(ctx)\r\n        {\r\n            ctx.font = \"24px Parisienne\";\r\n            // ctx.font = \"24px Sansita Swashed\";\r\n            // ctx.font = \"24px Roboto Mono\";\r\n        }\r\n\r\n        setContext(ctx);\r\n    }, []);\r\n\r\n\r\n    // useEffect(() => {\r\n    //     console.log('Canvas size', width, height);\r\n    // }, [width, height]);\r\n    \r\n    \r\n    \r\n    useEffect(() => {       \r\n        if(messages && context)\r\n        {\r\n            let name = messages.get(\"name\");\r\n            let remainingTiles = messages.get(\"remainingTiles\");\r\n\r\n            // console.log(\"useEffect messages name\", name);\r\n            // console.log(\"useEffect messages remainingTiles\", remainingTiles);\r\n\r\n            context.clearRect(0,0,size.width,size.height);\r\n            \r\n            if(name)\r\n            {\r\n                // context.fillText(name, 0, 30);\r\n            }\r\n            if(remainingTiles)\r\n            {\r\n                let measureText = context.measureText(remainingTiles);\r\n                context.fillText(remainingTiles, (size.width - measureText.width), 30);\r\n            }\r\n        } \r\n\r\n    }, [messages, context, size]);\r\n\r\n\r\n    return (\r\n        <canvas\r\n            id={\"messages\"} \r\n            width={size.width} \r\n            height={size.height} \r\n            style={{border:\"1px solid #000000\", position: \"absolute\", zIndex: 1}}\r\n        />\r\n    );\r\n}\r\n\r\n  \r\nexport default MessagesCanvas;","import React from 'react';\r\n\r\nimport {useState, useEffect} from 'react';\r\n\r\n\r\nimport { Playfield, Tile, TileWithCoordinates, Dimension, FieldType } from '../types/tile';\r\n\r\nimport {neighborhood, drawPlayFieldNeighborhood} from '../helpers/renderer';\r\n\r\n\r\nconst TouchHelperCanvas: React.FC<{size:Dimension, playfield:Playfield, tileSize:number, nextTile: Tile | TileWithCoordinates | null, defaultPatterns: string[] | null, images:(HTMLImageElement | null)[] | null}> = ({size, playfield, tileSize, nextTile, defaultPatterns, images}) => {\r\n       \r\n    const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\r\n\r\n    const [patterns, setPatterns] = useState<(string|CanvasPattern)[] | null>(defaultPatterns ? defaultPatterns : null);\r\n\r\n    useEffect(() => {\r\n        let c:HTMLCanvasElement|null = document.getElementById(\"touchHelper\") as HTMLCanvasElement;        \r\n        let ctx = c.getContext(\"2d\");\r\n        setContext(ctx);\r\n    }, []);\r\n\r\n\r\n    useEffect(() => {\r\n        if(context && patterns && images)\r\n        {\r\n            let newPatterns = [...patterns];\r\n\r\n            let img = images[FieldType.Earth];\r\n            if(img)\r\n            {\r\n                let p = context.createPattern(img, 'repeat');\r\n\r\n                if(p)\r\n                {\r\n                    newPatterns[FieldType.Earth] = p;\r\n\r\n                }\r\n            }\r\n\r\n\r\n            let img2 = images[FieldType.Water];\r\n            if(img2)\r\n            {\r\n                let p = context.createPattern(img2, 'repeat');\r\n\r\n                if(p)\r\n                {\r\n                    newPatterns[FieldType.Water] = p;\r\n                }\r\n            }\r\n            setPatterns(newPatterns);\r\n\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [images]); // context, patterns\r\n\r\n\r\n    // useEffect(() => {\r\n    //     console.log('Canvas size', width, height);\r\n    // }, [width, height]);\r\n       \r\n    \r\n\r\n    useEffect(() => {       \r\n        if(playfield && context)\r\n        {\r\n            // Build neighborhood\r\n            let playfieldNeighborhood = [{q:0, r:0}];\r\n            if(playfield.tiles.length > 0)\r\n            {\r\n                playfieldNeighborhood = [];\r\n                playfield.tiles.forEach(tile => {\r\n                    neighborhood.forEach(neighbor => {\r\n                        let testCoordinates = {q:tile.coordinates.q + neighbor.q, r:tile.coordinates.r + neighbor.r}\r\n\r\n                        let inNeighborhood = playfieldNeighborhood.find(n => n.q === testCoordinates.q && n.r === testCoordinates.r);\r\n                        if(!inNeighborhood)\r\n                        {\r\n                            let inPlayfield = playfield.tiles.find(n => n.coordinates.q === testCoordinates.q && n.coordinates.r === testCoordinates.r);\r\n\r\n                            if(!inPlayfield)\r\n                            {\r\n                                playfieldNeighborhood.push(testCoordinates);\r\n                            }\r\n                        }\r\n\r\n                    });\r\n                });\r\n            }\r\n\r\n            // Display neighborhood\r\n            if(context){\r\n                context.clearRect(0,0,size.width,size.height);\r\n                if(nextTile){\r\n                    drawPlayFieldNeighborhood(context, playfieldNeighborhood, tileSize, nextTile, patterns );\r\n                }\r\n            }\r\n        } \r\n\r\n    }, [playfield, context, size, tileSize, nextTile, patterns]);\r\n    \r\n\r\n\r\n    return (\r\n        <canvas\r\n            id={\"touchHelper\"}\r\n            width={size.width} \r\n            height={size.height} \r\n            style={{border:\"1px solid #000000\", position: \"absolute\", zIndex: 2}}\r\n        />\r\n    );\r\n}\r\n\r\n  \r\nexport default TouchHelperCanvas;","import React from 'react';\r\n\r\nimport {useState, useEffect} from 'react';\r\n\r\n\r\nimport { Tile, Dimension } from '../types/tile';\r\nimport {drawTile} from '../helpers/renderer';\r\nimport { drawMeeple } from '../helpers/drawMeeple';\r\n\r\n\r\nconst NextTileCanvas: React.FC<{size:Dimension, nextTile: Tile | null, patterns: string[], tileSize:number}> = ({size, nextTile, patterns, tileSize}) => {\r\n  \r\n    \r\n    const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\r\n\r\n    useEffect(() => {\r\n        let c:HTMLCanvasElement|null = document.getElementById(\"nextTile\") as HTMLCanvasElement;        \r\n        let ctx = c.getContext(\"2d\");\r\n        setContext(ctx);\r\n    }, []);\r\n\r\n\r\n    // useEffect(() => {\r\n    //     console.log('Canvas size', width, height);\r\n    // }, [width, height]);\r\n    \r\n    \r\n    useEffect(() => {        \r\n        if(context)\r\n        {\r\n            context.clearRect(0,0,size.width,size.height);\r\n            if(nextTile)\r\n            {\r\n                drawTile(context, {x: size.width/2, y: size.height/2}, tileSize, nextTile, patterns);\r\n\r\n\r\n\r\n                drawMeeple(context, {x: size.width/2, y: size.height/2}, tileSize, \"green\");\r\n\r\n            }\r\n        }\r\n\r\n    }, [size, context, nextTile, patterns, tileSize]);\r\n\r\n       \r\n    return (\r\n        <canvas\r\n            id={\"nextTile\"} \r\n            width={size.width} \r\n            height={size.height} \r\n            style={{border:\"1px solid #000000\", position: \"absolute\", zIndex: 0}}\r\n\r\n        />\r\n    );\r\n}\r\n\r\n  \r\nexport default NextTileCanvas;","\r\nimport { Point } from '../types/tile'\r\n\r\nexport const drawMeeple = function(ctx:CanvasRenderingContext2D, position:Point, tileSize:number, color:string) {\r\n\r\n    // console.log(\"drawMeeple\");\r\n    ctx.save();\r\n    ctx.translate(position.x-tileSize/2,position.y-tileSize/2);\r\n    ctx.scale(tileSize/100,tileSize/100);\r\n    ctx.fillStyle = color;\r\n    ctx.strokeStyle = 'black';\r\n    ctx.lineWidth = 2;\r\n    ctx.lineCap = 'butt';\r\n    ctx.lineJoin = 'miter';\r\n    ctx.miterLimit = 4;\r\n    ctx.beginPath();\r\n    ctx.moveTo(99.992,43.019);\r\n    ctx.bezierCurveTo(100.57,29.262,67.638,22.564,66.211,20.996);\r\n    ctx.bezierCurveTo(65.5,20.216,67.861,-0.015,50,0);\r\n    ctx.bezierCurveTo(32.139,-0.015,34.499,20.216,33.788,20.996);\r\n    ctx.bezierCurveTo(32.361,22.564,-0.569,29.262,0.008,43.019);\r\n    ctx.bezierCurveTo(0.584,56.777,18.059,49.711,21.786,53.76);\r\n    ctx.bezierCurveTo(25.046,57.304,6.507,79.989,4.433,94.394);\r\n    ctx.bezierCurveTo(3.757,99.089,5.077,100,9.64,100);\r\n    ctx.bezierCurveTo(17.916,100,25.817,99.995,33.093,99.995);\r\n    ctx.bezierCurveTo(36.38,99.995,37.549,98.106,39.245,95.503);\r\n    ctx.bezierCurveTo(42.999,89.741,47.533,80.479,50,80.48);\r\n    ctx.bezierCurveTo(52.466,80.479,57.001,89.741,60.755,95.502);\r\n    ctx.bezierCurveTo(62.451,98.106,63.619,99.994,66.906,99.994);\r\n    ctx.bezierCurveTo(74.181,99.994,82.083,99.999,90.359,99.999);\r\n    ctx.bezierCurveTo(94.922,99.999,96.243,99.088,95.566,94.393);\r\n    ctx.bezierCurveTo(93.493,79.988,74.955,57.303,78.213,53.7595);\r\n    ctx.bezierCurveTo(81.94,49.711,99.417,56.777,99.992,43.019);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.stroke();\r\n    ctx.restore();\r\n\r\n    // ctx.save();\r\n    // ctx.fillStyle = \"#000000\";\r\n    // ctx.translate(0,0);\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(0,0);\r\n    // ctx.lineTo(300,0);\r\n    // ctx.lineTo(300,300);\r\n    // ctx.lineTo(0,300);\r\n    // ctx.closePath();\r\n    // ctx.clip();\r\n    // ctx.translate(0,0);\r\n    // ctx.translate(0,0);\r\n    // ctx.scale(3,3);\r\n    // ctx.translate(0,0);\r\n    // ctx.strokeStyle = 'rgba(0,0,0,0)';\r\n    // ctx.lineCap = 'butt';\r\n    // ctx.lineJoin = 'miter';\r\n    // ctx.miterLimit = 4;\r\n    // ctx.save();\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(99.992,43.019);\r\n    // ctx.bezierCurveTo(100.570,29.262,67.638,22.564,66.211,20.996);\r\n    // ctx.bezierCurveTo(65.5,20.216,67.861,-0.015,50,0);\r\n    // ctx.bezierCurveTo(32.139,-0.015,34.499,20.216,33.788,20.996);\r\n    // ctx.bezierCurveTo(32.361,22.564,-0.5690000000000026,29.262,0.007999999999995566,43.019);\r\n    // ctx.bezierCurveTo(0.5839999999999955,56.777,18.058999999999994,49.711,21.785999999999994,53.76);\r\n    // ctx.bezierCurveTo(25.045999999999992,57.303999999999995,6.506999999999994,79.989,4.432999999999993,94.394);\r\n    // ctx.bezierCurveTo(3.757,99.089,5.077,100,9.64,100);\r\n    // ctx.bezierCurveTo(17.916,100,25.817,99.995,33.093,99.995);\r\n    // ctx.bezierCurveTo(36.38,99.995,37.549,98.106,39.245000000000005,95.503);\r\n    // ctx.bezierCurveTo(42.999,89.741,47.533,80.479,50,80.48);\r\n    // ctx.bezierCurveTo(52.466,80.479,57.001,89.741,60.755,95.502);\r\n    // ctx.bezierCurveTo(62.451,98.106,63.619,99.994,66.906,99.994);\r\n    // ctx.bezierCurveTo(74.181,99.994,82.083,99.999,90.359,99.999);\r\n    // ctx.bezierCurveTo(94.922,99.999,96.243,99.088,95.566,94.393);\r\n    // ctx.bezierCurveTo(93.493,79.988,74.955,57.303,78.213,53.7595);\r\n    // ctx.bezierCurveTo(81.94,49.711,99.417,56.777,99.992,43.019);\r\n    // ctx.closePath();\r\n    // ctx.fill();\r\n    // ctx.stroke();\r\n    // ctx.restore();\r\n    // ctx.restore();\r\n\r\n};","import React from 'react';\r\nimport './App.css';\r\n\r\nimport blueImagePath from '../src/patterns/ocean.jpg'; // gives image path\r\nimport brownImagePath from '../src/patterns/herbe.jpg'; // gives image path\r\n\r\n\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\n\r\n\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\n\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport TouchAppIcon from '@material-ui/icons/TouchAppTwoTone';\r\nimport MouseIcon from '@material-ui/icons/MouseTwoTone';\r\nimport RotateLeftIcon from '@material-ui/icons/RotateLeftTwoTone';\r\nimport RotateRightIcon from '@material-ui/icons/RotateRightTwoTone';\r\n\r\n// HOOKS\r\nimport {useState, useEffect} from 'react';\r\n\r\n// CUSTOM HOOKS\r\nimport useWindowSize from \"../src/utils/useWindowSize\";\r\nimport useImage from \"../src/utils/useImage\";\r\n\r\nimport { name, version } from \"../package.json\";\r\n\r\nimport deck from '../src/data/tuile';\r\nimport { defaultPatterns } from '../src/data/tuile';\r\n\r\nimport { shuffleArray, rotateArray } from './helpers/deck';\r\n\r\nimport { computeSize, pixel_to_pointy_hex, neighborhood, computeOffset } from '../src/helpers/renderer';\r\n\r\n\r\n\r\nimport BackgroundCanvas from './components/BackgroundCanvas';\r\nimport ForegroundCanvas from './components/ForegroundCanvas';\r\nimport MessagesCanvas from './components/MessagesCanvas';\r\nimport TouchHelperCanvas from './components/TouchHelperCanvas';\r\nimport NextTileCanvas from './components/NextTileCanvas';\r\n\r\n\r\nimport { Tile, TileWithCoordinates, Point, Playfield, Dimension, FieldType } from './types/tile';\r\n\r\n\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      flexGrow: 1,\r\n    },\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n    title: {\r\n      flexGrow: 1,\r\n    },\r\n\r\n    appBar: {\r\n      top: 'auto',\r\n      bottom: 0,\r\n      '& > div': {alignItems: 'flex-start'}\r\n    },\r\n    grow: {\r\n      flexGrow: 1,\r\n    },\r\n\r\n    canvasesContainer: {\r\n      position: 'absolute'\r\n    },\r\n\r\n  }),\r\n);\r\n\r\n\r\nconst App: React.FC = () => {\r\n\r\n  const classes = useStyles();\r\n\r\n  const [touchMode] = useState<boolean>(navigator.maxTouchPoints > 0);\r\n\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n\r\n  const { windowInnerWidth, windowInnerHeight } = useWindowSize();\r\n\r\n  const [canvasSize, setCanvasSize] = useState<Dimension>({width:0, height:0});\r\n  \r\n  const [tileSize, setTileSize] = useState(25);\r\n\r\n  const [nextTile, setNextTile] = useState<Tile | null>(null);\r\n  const [remainingTiles, setRemainingTiles] = useState<number[]>([]);\r\n\r\n  const [playfield, setPlayfield] = useState<Playfield>({tiles: []});\r\n\r\n  const [messages, setMessages] = useState<Map<string,string>>(new Map<string,string>());\r\n\r\n  \r\n  // const [images, setImages] = useState<Map<FieldType,HTMLImageElement>>(new Map<FieldType,HTMLImageElement>());\r\n  const [images, setImages] = useState<(HTMLImageElement|null)[]>(defaultPatterns.map(x => null));\r\n  // const [images, setImages] = useState<string[]>([]);\r\n\r\n\r\n\r\n  const [blueImage, blueImageStatus] = useImage(blueImagePath);\r\n  const [brownImage, brownImageStatus] = useImage(brownImagePath);\r\n\r\n  useEffect(() => {\r\n    if(blueImageStatus === 'loaded' && !images[FieldType.Water])\r\n    {\r\n      let newImages = [...images]\r\n      newImages[FieldType.Water] = blueImage as HTMLImageElement;\r\n      setImages(newImages);\r\n    }    \r\n  }, [blueImage, blueImageStatus, images]);\r\n\r\n\r\n  useEffect(() => {\r\n    if(brownImageStatus === 'loaded' && !images[FieldType.Earth])\r\n    {\r\n      let newImages = [...images]\r\n      newImages[FieldType.Earth] = brownImage as HTMLImageElement;\r\n      setImages(newImages);\r\n    }    \r\n  }, [brownImage, brownImageStatus, images]);\r\n\r\n  \r\n  useEffect(() => {    \r\n      // const handleLoadedImage = (event:Event) => {\r\n\r\n      //   // console.log(\"handleLoadedImage event\", event, images);\r\n      //   images.push(event.target as HTMLImageElement);\r\n    \r\n      //   // let newImages = [...images, (event.target as HTMLImageElement).id];\r\n      //   // setImages(newImages);\r\n    \r\n      //   if((event.target as HTMLImageElement).id === FieldType.Water.toString())\r\n      //   {\r\n      //     let brownImage = new Image();\r\n      //     brownImage.id = FieldType.Earth.toString();\r\n      //     brownImage.src = brownImagePath;\r\n      //     brownImage.onload= handleLoadedImage;\r\n      //   }\r\n        \r\n      //   if((event.target as HTMLImageElement).id === FieldType.Earth.toString())\r\n      //   {\r\n      //     setImages([...images]);\r\n      //   }\r\n      //   // console.log(\"handleLoadedImage newImages\", newImages);\r\n      //   console.log(\"handleLoadedImage images\", images);\r\n      // }\r\n\r\n\r\n      console.log('Window initial size', window.innerWidth, window.innerHeight);\r\n\r\n      let initialWidth = window.innerWidth -2; //-2 for border\r\n      let initialHeight = window.innerHeight -2; //-2 for border\r\n\r\n      let topBar = document.getElementById('topBar');\r\n      if(topBar)\r\n      {\r\n        initialHeight = initialHeight - topBar.scrollHeight;\r\n      }\r\n      let bottomBar = document.getElementById('bottomBar');\r\n      if(bottomBar)\r\n      {\r\n        initialHeight = initialHeight - bottomBar.scrollHeight;\r\n      }\r\n\r\n      console.log('Canvas initial size', initialWidth, initialHeight);\r\n\r\n      setCanvasSize({width: initialWidth, height: initialHeight});\r\n\r\n      let initialSize = computeSize({tiles:[]}, {width: initialWidth, height: initialHeight}, true);\r\n\r\n      let versionFromStorage = localStorage.getItem('version');\r\n      if(versionFromStorage && version === JSON.parse(versionFromStorage))\r\n      {\r\n        let playfieldStringFromStorage = localStorage.getItem('playfield');\r\n        let remainingTilesStringFromStorage = localStorage.getItem('remainingTiles');\r\n        if(playfieldStringFromStorage && remainingTilesStringFromStorage){\r\n          let playfieldFromStorage = JSON.parse(playfieldStringFromStorage) as Playfield;\r\n          let remainingTilesFromStorage = JSON.parse(remainingTilesStringFromStorage) as number[];\r\n    \r\n          if(playfieldFromStorage && remainingTilesFromStorage){\r\n            console.log(\"restoring old game\", playfieldStringFromStorage);\r\n    \r\n    \r\n            let tile = deck.tiles.find(x => x.tile.id === remainingTilesFromStorage[0]);\r\n            let nextTile = tile ? tile.tile : null;  \r\n          \r\n            setNextTile(nextTile);\r\n            setPlayfield(playfieldFromStorage);\r\n            setRemainingTiles(remainingTilesFromStorage);\r\n    \r\n            let newTileSize = computeSize(playfieldFromStorage, {width: initialWidth, height: initialHeight}, remainingTilesFromStorage.length > 0);\r\n            \r\n            console.log(\"restoring old game newTileSize\", newTileSize);\r\n  \r\n            setTileSize(newTileSize);\r\n            \r\n            return;\r\n          }\r\n        }\r\n      }\r\n      else\r\n      {\r\n        console.log(\"Not same version\", version,versionFromStorage);\r\n      }      \r\n      \r\n      handleNewGame();\r\n      setTileSize(initialSize);\r\n\r\n\r\n      // // Patterns initialisation\r\n      \r\n      // console.log(\"Patterns initialisation\");\r\n      // let blueImage = new Image();\r\n      // blueImage.id = FieldType.Water.toString();\r\n      // blueImage.src = blueImagePath;\r\n      \r\n      // blueImage.onload = handleLoadedImage;\r\n\r\n        \r\n      // console.log(\"Patterns initialisation ?\");\r\n\r\n  }, []);\r\n\r\n\r\n\r\n  useEffect(() => {        \r\n    let newWidth = windowInnerWidth -2; //-2 for border\r\n    let newHeight = windowInnerHeight -2; //-2 for border\r\n\r\n    let topBar = document.getElementById('topBar');\r\n    if(topBar)\r\n    {\r\n      newHeight = newHeight - topBar.scrollHeight;\r\n    }\r\n    let bottomBar = document.getElementById('bottomBar');\r\n    if(bottomBar)\r\n    {\r\n      newHeight = newHeight - bottomBar.scrollHeight;\r\n    }    \r\n    setCanvasSize({width: newWidth, height: newHeight});\r\n  }, [windowInnerWidth, windowInnerHeight]);\r\n\r\n\r\n  useEffect(() => {\r\n    let newTileSize = computeSize(playfield, canvasSize, remainingTiles.length > 0);  \r\n    setTileSize(newTileSize);\r\n  }, [canvasSize, playfield]);\r\n\r\n\r\nconst handleCtrlZ = () => {\r\n  \r\n  console.log(\"handleCtrlZ\", playfield.tiles.length);\r\n  if(playfield.tiles.length > 0)\r\n  {\t\t\r\n\r\n    let newPlayfield = {...playfield, tiles:[...playfield.tiles]};\r\n \r\n\r\n    let newNextTile = newPlayfield.tiles.pop() as Tile;\r\n    \r\n    let newRemainingTiles = [newNextTile.id, ...remainingTiles];\r\n    \r\n    setNextTile(newNextTile);\r\n    setPlayfield(newPlayfield);\r\n    setRemainingTiles(newRemainingTiles);\r\n  }\r\n\r\n  // var audio = document.getElementById(\"audio\") as HTMLAudioElement;\r\n  // audio.play();\r\n\r\n}\r\n\r\nconst handleNewGame = () => {\r\n  \r\n  let flattedDeck = deck.tiles.map(t => {\r\n    let a = [];\r\n    for(var i = 0; i<t.quantity; i++) {\r\n      a.push(t.tile.id);\r\n    }\r\n    return a;\r\n  }).flat();\r\n\r\n  let shuffledDeck = shuffleArray(flattedDeck);\r\n\r\n  let tile = deck.tiles.find(x => x.tile.id === shuffledDeck[0]);\r\n  let nextTile = tile ? tile.tile : null;  \r\n\r\n  setNextTile(nextTile);\r\n  setPlayfield({tiles: []});\r\n  setRemainingTiles(shuffledDeck);\r\n}\r\n\r\n\r\n\r\nconst handleShowTiles = () => {\r\n  \r\n  let flattedDeck = deck.tiles.map(t => t.tile).flat();\r\n\r\n  let canvasSizeRatio = canvasSize.height / canvasSize.width;\r\n\r\n  let nbLines = 1;\r\n\r\n  let ratio = nbLines/(flattedDeck.length/nbLines);\r\n\r\n  while (ratio<canvasSizeRatio) {\r\n    nbLines++;\r\n    ratio = nbLines/(flattedDeck.length/nbLines);\r\n  }\r\n\r\n  const nbPerLine = Math.ceil(flattedDeck.length / nbLines);\r\n\r\n  let newPlayfield:Playfield = {tiles: []};\r\n\r\n  let q = 0;\r\n  let r = 0;\r\n  for(let i = 0; i < flattedDeck.length; i++)\r\n  {\r\n    let newTileWithCoordinates:TileWithCoordinates = {...flattedDeck[i], coordinates: {q:q, r:r}};\r\n\r\n    q = q+2;\r\n    if(((q+r/2)/2) % nbPerLine === 0)\r\n    {\r\n      r = r+2;\r\n      q = -r/2;\r\n    }\r\n\r\n    newPlayfield.tiles.push(newTileWithCoordinates);\r\n  }\r\n\r\n\r\n  setNextTile(null);\r\n  setPlayfield(newPlayfield);\r\n  setRemainingTiles([]);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nuseEffect(() => {\r\n  var newMessages = new Map([\r\n    [ \"name\", `${name} - ${version}` ],\r\n    [ \"remainingTiles\", `${remainingTiles.length}` ]\r\n  ]);\r\n  setMessages(newMessages);\r\n}, [remainingTiles.length]);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    localStorage.setItem('version', JSON.stringify(version));\r\n    localStorage.setItem('playfield', JSON.stringify(playfield));\r\n    localStorage.setItem('remainingTiles', JSON.stringify(remainingTiles));    \r\n\r\n  }, [playfield, remainingTiles]);\r\n\r\n\r\n  // useEffect(() => {\r\n  //   console.log(\"useEffect images\", images);\r\n  // }, [images]);\r\n\r\n  const handleClickMenu = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleCloseMenu = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n\r\n  const handleClick = (position:Point) => {    \r\n\r\n    if(!nextTile)\r\n    {\r\n      return;\r\n    }\r\n    \r\n\t\tvar coordinates = {q: 0, r: 0};\r\n\t\tif(playfield.tiles.length !== 0){\r\n\r\n      let offset = computeOffset(canvasSize, playfield.tiles.map(tile => tile.coordinates), tileSize);\r\n\r\n\t\t\tcoordinates = pixel_to_pointy_hex({x: position.x - offset.x, y: position.y - offset.y}, tileSize);\r\n\t\t}\r\n\t\t\r\n\t\t// Test that space is free\r\n\t\tlet inoccupied = playfield.tiles.find(t => t.coordinates.q === coordinates.q && t.coordinates.r === coordinates.r) === undefined;\t\t\r\n\t\tif(!inoccupied)\r\n\t\t{\r\n\t\t\t// console.warn(\"Already something here : \", coordinates);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// Test that space is adjacent\r\n\t\tif(playfield.tiles.length !== 0){\r\n\t\t\tlet counter = 0;\r\n\t\t\tlet neighbor = false;\r\n\t\t\tdo {\r\n        let checkCoordinates = {q: coordinates.q + neighborhood[counter].q, r: coordinates.r + neighborhood[counter].r };\r\n        neighbor = playfield.tiles.find(t => t.coordinates.q === checkCoordinates.q && t.coordinates.r === checkCoordinates.r) !== undefined ;\r\n\t\t\t\tcounter++;\r\n\t\t\t} while (!neighbor && (counter < neighborhood.length));\r\n\t\t\tif(!neighbor)\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n    if(touchMode)\r\n    {\r\n      if(nextTile.hasOwnProperty(\"coordinates\"))\r\n      {\r\n        let nextTileCoordinates = (nextTile as TileWithCoordinates).coordinates;\r\n        if(nextTileCoordinates.q !== coordinates.q || nextTileCoordinates.r !== coordinates.r)\r\n        {\r\n          let newNextTile = { ...nextTile, coordinates:coordinates};\r\n          setNextTile(newNextTile);\r\n          return;\r\n        }\r\n      }\r\n      else {\r\n        let newNextTile = { ...nextTile, coordinates:coordinates};\r\n        setNextTile(newNextTile);\r\n        return;\r\n      }\r\n    }\r\n\r\n\r\n\t\tlet newPlayfield = {...playfield, tiles: [...playfield.tiles, {...nextTile as Tile, coordinates}]};\r\n    \r\n    let newRemainingTiles = [...remainingTiles];\r\n\t\tif(newRemainingTiles.length > 0)\r\n\t\t{\r\n\t\t\tnewRemainingTiles.shift();\r\n      const newNextTile = deck.tiles.find(x => x.tile.id === newRemainingTiles[0])?.tile;\r\n      \r\n      setNextTile(newNextTile ? newNextTile : null);\r\n    }\r\n    else {\r\n      setNextTile(null);\r\n    }\t\t\r\n    setPlayfield(newPlayfield);\r\n    setRemainingTiles(newRemainingTiles);\r\n}\r\n\r\n\r\nconst handleWheel = (delta:Number) => {    \r\n  if(!nextTile)\r\n  {\r\n    return;\r\n  }\r\n\r\n  if(!nextTile.edges)\r\n  {\r\n    return;\r\n  }\r\n\r\n  let newNextTile = {\r\n    ...nextTile,  \r\n    edges: rotateArray(nextTile.edges, delta > 0 ? -1 : 1)\r\n  };\r\n\r\n  setNextTile(newNextTile);\r\n}\r\nconst handleRotateLeft = () => {\r\n  handleRotate(-1);\r\n}\r\nconst handleRotateRight = () => {\r\n  handleRotate(1);\r\n}\r\nconst handleRotate = (delta: number) => {  \r\n  handleWheel(delta);\r\n}\r\n\r\n\r\nconst handleKeyUp = (event:React.KeyboardEvent<HTMLElement>) => {\r\n  event.preventDefault();\r\n  event.persist();\r\n  event.stopPropagation();\r\n\r\n  console.log(\"handleKeyUp event\", event);\r\n  console.log(\"handleKeyUp event\", event.key);\r\n\r\n  var newMessages = new Map([\r\n    [ \"name\", `${event.key}` ],\r\n    [ \"remainingTiles\", `${remainingTiles.length}` ]\r\n  ]);\r\n  setMessages(newMessages);\r\n\r\n\r\n  if(event.key === 'z' && event.ctrlKey)\r\n  {\t\t\r\n    handleCtrlZ();\r\n  }\r\n  if(event.key === 'Backspace')\r\n  {\t\t\r\n    handleCtrlZ();\r\n  }\r\n}\r\n\r\n\r\nconst handleCapture = (event:React.MouseEvent<HTMLLIElement, MouseEvent>) => {\r\n\r\n  // console.log('handleCapture', event);\r\n\r\n  let backgroundCanvas = document.getElementById(\"background\") as HTMLCanvasElement;\r\n\r\n  // let dataURL = backgroundCanvas.toDataURL(\"image/png\");\r\n\r\n  // console.log('handleCapture', event.nativeEvent);\r\n  // if(event.nativeEvent && event.nativeEvent.target)\r\n  // {\r\n  //   event.currentTarget.src = dataURL;\r\n  // }\r\n\r\n  window.location.href = backgroundCanvas.toDataURL(\"image/png\");\r\n}\r\n\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className={classes.root} onKeyUp={handleKeyUp} tabIndex={0}>\r\n        <AppBar id={\"topBar\"} position=\"static\" >\r\n          <Toolbar>\r\n\r\n            <IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\" onClick={handleClickMenu}>\r\n              <MenuIcon />\r\n            </IconButton>\r\n\r\n            <Typography variant=\"h6\" className={classes.title}>\r\n            {`${name} - ${version}`}\r\n            </Typography>\r\n\r\n            \r\n\r\n            {touchMode && (            \r\n              <IconButton edge=\"end\" className={classes.menuButton} color=\"inherit\" aria-label=\"touchApp\">\r\n                <TouchAppIcon /> {navigator.maxTouchPoints}\r\n              </IconButton>            \r\n            )}\r\n            \r\n            {!touchMode && (            \r\n              <IconButton edge=\"end\" className={classes.menuButton} color=\"inherit\" aria-label=\"mouseApp\">\r\n                <MouseIcon />\r\n              </IconButton>            \r\n            )}\r\n\r\n          </Toolbar>\r\n        </AppBar>\r\n\r\n        <Menu\r\n                id=\"simple-menu\"\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={handleCloseMenu}\r\n              >\r\n                <MenuItem onClick={() => {handleCloseMenu(); handleNewGame();}}>New game</MenuItem>\r\n                <MenuItem onClick={() => {handleCloseMenu(); handleCtrlZ();}}>Undo</MenuItem>\r\n                <MenuItem onClick={() => {handleCloseMenu(); handleShowTiles();}}>Show tiles</MenuItem>\r\n                <MenuItem onClick={(e) => {handleCloseMenu(); handleCapture(e);}}>Capture</MenuItem>\r\n        </Menu>\r\n\r\n\r\n        {canvasSize.width && canvasSize.height && (\r\n        <div id={\"canvasesContainer\"} className={classes.canvasesContainer}>\r\n\r\n          <BackgroundCanvas size={canvasSize} defaultPatterns={defaultPatterns} playfield={playfield} tileSize={tileSize} images={images}/>\r\n          <MessagesCanvas size={canvasSize} messages={messages}/>\r\n\r\n          {touchMode && (<TouchHelperCanvas size={canvasSize} playfield={playfield} tileSize={tileSize} nextTile={nextTile} defaultPatterns={defaultPatterns} images={images}/>)}\r\n          {!touchMode && (<TouchHelperCanvas size={canvasSize} playfield={playfield} tileSize={tileSize} nextTile={null} defaultPatterns={null}  images={null}/>)}\r\n          \r\n\r\n          <ForegroundCanvas size={canvasSize}  nextTile={!touchMode ? nextTile : null} defaultPatterns={defaultPatterns} onClick={handleClick}  onWheel={handleWheel} tileSize={tileSize} images={images}/>\r\n        </div>\r\n      )}\r\n\r\n        \r\n      {touchMode && (\r\n        <AppBar id={\"bottomBar\"} position=\"fixed\" color=\"primary\" className={classes.appBar}>\r\n          <Toolbar>\r\n            <IconButton edge=\"start\" color=\"inherit\" aria-label=\"rotate left\" onClick={handleRotateLeft} disabled={!nextTile}>\r\n              <RotateLeftIcon />\r\n            </IconButton>\r\n            <div className={classes.grow} />\r\n            <div>\r\n              <NextTileCanvas size={{width:48, height:48}} nextTile={nextTile} patterns={defaultPatterns} tileSize={24}/>\r\n            </div>\r\n            <div className={classes.grow} />\r\n            <IconButton edge=\"end\" color=\"inherit\" aria-label=\"rotate right\" onClick={handleRotateRight} disabled={!nextTile}>\r\n              <RotateRightIcon />\r\n            </IconButton>\r\n          </Toolbar>\r\n        </AppBar>      \r\n      )} \r\n        \r\n\r\n\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}