(this.webpackJsonphex=this.webpackJsonphex||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var i,o=n(0),l=n.n(o),a=n(7),r=n.n(a),c=(n(13),n(3)),s=n(5),u=n(1);n(14);!function(e){e[e.Water=0]="Water",e[e.Earth=1]="Earth",e[e.Forest=2]="Forest",e[e.Desert=3]="Desert"}(i||(i={}));var f={id:1,name:"Toute eau",center:i.Water,edges:[i.Water,i.Water,i.Water,i.Water,i.Water,i.Water]},h={id:14,name:"Toute eau simple",center:i.Water},d=["#7dd1ff","#a65a35"],g={tiles:[{tile:f,quantity:3},{tile:h,quantity:1}]};var m=Math.cos(Math.PI/6);function v(e,t,n,i,o){var l=n/3,a=t.x,r=t.y,c=n;if(i){if(!i.edges)return e.fillStyle=o[i.center],void T(e,t,n);e.beginPath(),e.moveTo(a-c*m,r-.5*c),e.lineTo(a-c*m,r+.5*c),e.lineTo(a-l*m,r+.5*l),e.lineTo(a-l*m,r-.5*l),e.closePath(),e.fillStyle=o[i.edges[0]],e.fill(),e.beginPath(),e.moveTo(a-c*m,r+.5*c),e.lineTo(a,r+c),e.lineTo(a,r+l),e.lineTo(a-l*m,r+.5*l),e.closePath(),e.fillStyle=o[i.edges[1]],e.fill(),e.beginPath(),e.moveTo(a,r+c),e.lineTo(a+c*m,r+.5*c),e.lineTo(a+l*m,r+.5*l),e.lineTo(a,r+l),e.closePath(),e.fillStyle=o[i.edges[2]],e.fill(),e.beginPath(),e.moveTo(a+c*m,r+.5*c),e.lineTo(a+c*m,r-.5*c),e.lineTo(a+l*m,r-.5*l),e.lineTo(a+l*m,r+.5*l),e.closePath(),e.fillStyle=o[i.edges[3]],e.fill(),e.beginPath(),e.moveTo(a+c*m,r-.5*c),e.lineTo(a,r-c),e.lineTo(a,r-l),e.lineTo(a+l*m,r-.5*l),e.closePath(),e.fillStyle=o[i.edges[4]],e.fill(),e.beginPath(),e.lineTo(a,r-c),e.lineTo(a-c*m,r-.5*c),e.lineTo(a-l*m,r-.5*l),e.lineTo(a,r-l),e.closePath(),e.fillStyle=o[i.edges[5]],e.fill(),e.beginPath(),e.moveTo(a-l*m,r-.5*l),e.lineTo(a-l*m,r+.5*l),e.lineTo(a,r+l),e.lineTo(a+l*m,r+.5*l),e.lineTo(a+l*m,r-.5*l),e.lineTo(a,r-l),e.lineTo(a-l*m,r-.5*l),e.closePath(),e.fillStyle=o[i.center],e.fill()}else T(e,t,n)}function T(e,t,n){var i=t.x,o=t.y,l=n;e.beginPath(),e.moveTo(i-l*m,o-.5*l),e.lineTo(i-l*m,o+.5*l),e.lineTo(i,o+l),e.lineTo(i+l*m,o+.5*l),e.lineTo(i+l*m,o-.5*l),e.lineTo(i,o-l),e.lineTo(i-l*m,o-.5*l),e.closePath(),e.fillStyle="orange",e.fill()}function b(e,t){return{x:t*(Math.sqrt(3)*e.coordinates.q+Math.sqrt(3)/2*e.coordinates.r),y:t*(1.5*e.coordinates.r)}}function x(e,t,n){var i={min:0,max:0},o=2+1.5*((i=e.tiles.reduce((function(e,t){return{min:Math.min(e.min,t.coordinates.r),max:Math.max(e.max,t.coordinates.r)}}),i)).max+-i.min+1+2-1),l=Math.floor(n/o),a=t/6/m;if(a=Math.floor(a),e.tiles.length>0){for(var r={min:Number.MAX_VALUE,max:Number.MIN_VALUE},c=0;c<e.tiles.length;c++){var s=b(e.tiles[c],10);r.min=Math.min(s.x,r.min),r.max=Math.max(s.x,r.max)}a=t/(2*((r.max-r.min+20*m)/(20*m)+2))/m,a=Math.floor(a)}return Math.min(l,a)}var w=function(e){var t=e.id,n=e.width,i=e.height,a=e.zIndex,r=e.nextTile,c=e.patterns,s=e.onClick,f=e.playfield,h=e.tileSize,d=Object(o.useState)({x:0,y:0}),g=Object(u.a)(d,2),m=g[0],T=g[1],x=Object(o.useState)(null),w=Object(u.a)(x,2),y=w[0],j=w[1];Object(o.useEffect)((function(){var e=document.getElementById(t).getContext("2d");e&&(e.font="30px Arial"),j(e)}),[]),Object(o.useEffect)((function(){console.log("Canvas size",n,i)}),[n,i]),Object(o.useEffect)((function(){y&&m.x&&m.y&&(y.clearRect(0,0,n,i),r&&v(y,m,h,r,c))}),[m,n,i,y,r]),Object(o.useEffect)((function(){"foreground"===t&&y&&console.log("Pattern initialisation")}),[y]),Object(o.useEffect)((function(){if(f&&y){console.log("Redraw",f,h),y.clearRect(0,0,n,i),function(e,t,n,i){for(var o=0;o<t.tiles.length;o++){var l=t.tiles[o],a=b(l,n);v(e,{x:e.canvas.width/2+a.x,y:e.canvas.height/2+a.y},n,l,i)}}(y,f,h,c),console.log("context",y.font),console.log("measureText");var e=y.measureText("Remaining tile 4");y.strokeText("Remaining tile 4",(n-e.width)/2,30),e=y.measureText("fillText"),y.fillText("fillText",(n-e.width)/2,i-30)}}),[f,h]);return l.a.createElement("canvas",{id:t,width:n,height:i,style:{border:"1px solid #000000",position:"absolute",zIndex:a},onMouseMove:function(e){e.preventDefault(),e.persist();var t={x:e.clientX,y:e.clientY};T(t)},onClick:function(e){e.preventDefault(),e.persist();var t={x:e.clientX,y:e.clientY};T(t),s&&s(t)}})},y=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],j=function(){var e=Object(o.useState)(0),t=Object(u.a)(e,2),n=t[0],i=t[1],a=Object(o.useState)(0),r=Object(u.a)(a,2),f=r[0],h=r[1],m=Object(o.useState)(25),v=Object(u.a)(m,2),T=v[0],b=v[1],j=Object(o.useState)(null),O=Object(u.a)(j,2),M=O[0],p=O[1],E=Object(o.useState)([]),P=Object(u.a)(E,2),S=P[0],q=P[1],W=Object(o.useState)({tiles:[]}),k=Object(u.a)(W,2),z=k[0],C=k[1];Object(o.useEffect)((function(){console.log("Window initial size",window.innerWidth,window.innerHeight),i(window.innerWidth),h(window.innerHeight);var e=x({tiles:[]},window.innerWidth,window.innerHeight);console.log("initial tile size",e),b(e)}),[]),Object(o.useEffect)((function(){console.log(g);var e=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}return e}(g.tiles.map((function(e){for(var t=[],n=0;n<e.quantity;n++)t.push(e.tile.id);return t})).flat());console.log("shuffledDeck",e);var t=g.tiles.find((function(t){return t.tile.id===e[0]})),n=t?t.tile:null;p(n),q(e)}),[]),Object(o.useEffect)((function(){var e=navigator.userAgent.toLowerCase().match(/mobile/i);console.log("isMobile ?",navigator.userAgent),console.log("isMobile ?",navigator.userAgent.toLowerCase()),console.log("isMobile ?",navigator.userAgent.toLowerCase().match(/mobile/i)),e?console.log("isMobile",!0):console.log("isMobile",!1),console.log("maxTouchPoints ?",navigator.maxTouchPoints)}),[]);return l.a.createElement(l.a.Fragment,null,n&&f&&l.a.createElement(l.a.Fragment,null,l.a.createElement(w,{id:"background",width:n,height:f,zIndex:0,nextTile:null,patterns:d,onClick:null,playfield:z,tileSize:T}),l.a.createElement(w,{id:"foreground",width:n,height:f,zIndex:1,nextTile:M,patterns:d,onClick:function(e){console.log("handleClick in app",e);var t={q:0,r:0};if(0!==z.tiles.length&&(t=function(e,t){var n=(Math.sqrt(3)/3*e.x-1/3*e.y)/t,i=2/3*e.y/t;return{q:Math.round(n),r:Math.round(i)}}({x:e.x-n/2,y:e.y-f/2},T)),void 0===z.tiles.find((function(e){return e.coordinates.q===t.q&&e.coordinates.r===t.r}))){if(0!==z.tiles.length){var i=0,o=!1,l=function(){var e=t.q+y[i].q,n=t.r+y[i].r;o=void 0===z.tiles.find((function(t){return t.coordinates.q===e&&t.coordinates.r===n})),i++};do{l()}while(!o&&i<y.length);if(!o)return void console.warn("No neighbor : ",t)}var a=Object(s.a)({},z,{tiles:[].concat(Object(c.a)(z.tiles),[Object(s.a)({},M,{coordinates:t})])}),r=Object(c.a)(S);if(r.length>0){var u;r.shift();var h=null===(u=g.tiles.find((function(e){return e.tile.id===r[0]})))||void 0===u?void 0:u.tile;p(h||null)}else p(null);console.log("newRemainingTiles",r),console.log("newPlayfield",a);var d=x(a,n,f);b(d),C(a),q(r)}else console.warn("Already something here : ",t)},playfield:null,tileSize:T})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.f894004f.chunk.js.map